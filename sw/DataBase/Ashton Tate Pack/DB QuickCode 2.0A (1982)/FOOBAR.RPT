*     foobar.RPT     -REPORT PROGRAM
* IF REPORT DOESNT EXIST, GO INTO dBASE
STORE   '   '  TO MQ:RLPT
DO WHILE MQ:RLPT <>  'Y'  .AND. MQ:RLPT <>  'N'
STORE  'Y'  TO MQ:RLPT
@ 21,10 SAY  ' WANT REPORT SENT TO THE PRINTER? '  GET MQ:RLPT
READ
ENDDO
IF MQ:RLPT= 'N'
  STORE  ' '  TO MQ:RDSK
  DO WHILE MQ:RDSK <>  'Y'  .AND. MQ:RDSK<>  'N'
  STORE  'N'  TO MQ:RDSK
@ 21,10 SAY  ' WANT REPORT SENT TO A FILE ?       '  GET MQ:RDSK
READ
ENDDO
IF MQ:RDSK= 'Y'
STORE  '          '  TO MQ:RFILE
DO WHILE MQ:RFILE =  '          '
@ 22,10 SAY  ' ENTER FILE NAME '  GET MQ:RFILE
READ
ENDDO
STORE TRIM(MQ:RFILE) TO MQ:RFILE
ENDIF  RDSK
ENDIF  RLPT=N
STORE  '        '  TO MQ:RPT
  DO WHILE MQ:RPT =  '   '
@ 23,10 SAY  ' ENTER REPORT NAME '  GET MQ:RPT
READ
ENDDO
IF MQ:RLPT =  'Y'
@ 23,10 SAY  ' PLEASE SET UP PRINTER           '
SET CONSOLE OFF
WAIT
SET CONSOLE ON
SET PRINT ON
ENDIF RLPT
IF MQ:RDSK =  'Y'
SET ALTERNATE TO &MQ:RFILE
SET ALTERNATE ON
ENDIF RDSK
ERASE
REPORT FORM &MQ:RPT
SET PRINT OFF
SET ALTERNATE OFF
IF MQ:RDSK = 'Y'
  RELEASE MQ:RDSK,MQ:RFILE
ENDIF
RELEASE MQ:RLPT, MQ:RPT