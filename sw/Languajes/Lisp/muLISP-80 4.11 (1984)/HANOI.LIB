% File:  HANOI.LIB  (c)		05/01/83	The Soft Warehouse %


(LOOP (PRIN1 (QUOTE *)) (EVAL (READ)) ((NULL RDS)) )

(PUTD (QUOTE DEFUN) (QUOTE (NLAMBDA (NAM$ EXP$)
  (PUTD NAM$ EXP$)
  NAM$ )))

(DEFUN SETQQ (NLAMBDA (NAM$ EXP$)
  (SET NAM$ EXP$)
  NAM$ ))


(DEFUN HANOI (LAMBDA (NUM A B C TAB1 TAB2)
  (SETQ A (MKTOWER NUM ALPHABET))
  (SETQ TAB1 (PLUS (LENGTH (PACK A)) 4))
  (SETQ TAB2 (TIMES 2 TAB1))
  (PRINTTOWERS)
  (XFER NUM (QUOTE A) (QUOTE B) (QUOTE C))
  (QUOTE " ") ))

(DEFUN MKTOWER (LAMBDA (NUM ALPHABET TOWER)
  (LOOP
    ((ZEROP NUM)
      (REVERSE TOWER) )
    (PUSH (POP ALPHABET) TOWER)
    (SETQ NUM (SUB1 NUM)) ) ))

(DEFUN XFER (LAMBDA (NUM SOURCE DEST SPARE)
  ((ZEROP NUM))
  (XFER (SUB1 NUM) SOURCE SPARE DEST)
  (MOVE SOURCE DEST)
  (XFER (SUB1 NUM) SPARE DEST SOURCE) ))

(DEFUN MOVE (LAMBDA (SOURCE DEST)
  (SET DEST (CONS (CAR (EVAL SOURCE)) (EVAL DEST)))
  (SET SOURCE (CDR (EVAL SOURCE)))
  (PRINTTOWERS) ))

(DEFUN PRINTTOWERS (LAMBDA NIL
  (TERPRI)
  (PRINHANOI A)
  (TAB TAB1)
  (PRINHANOI B)
  (TAB TAB2)
  (PRINHANOI C) ))

(DEFUN PRINHANOI (LAMBDA (LST)
  (LOOP
    ((NULL LST))
    (PRIN1 (POP LST)) ) ))

(DEFUN SUB1 (LAMBDA (NUM)
  (DIFFERENCE NUM 1) ))

(DEFUN TAB (LAMBDA (NUM)
  (SPACES (DIFFERENCE NUM (SPACES))) ))

(SETQQ ALPHABET (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z))

(HANOI 7 (RDS))
