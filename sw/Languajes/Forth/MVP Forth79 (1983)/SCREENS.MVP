(DIRECTORY¨MVP-FORTH)¿15ÉASSEMBLERÅLOADÅSCREENÖ(Å16-58)Ÿ60ÉEDITORÅLOADÅSCREENà(Å61-78)Ÿ110ÇMVP-FORTHÅUTILITIESá(Å111-122)◊125ÇMVP-FORTHÅSUPPLEMENTALSÉ(Å126-128)‰NEW130ÇMVP-FORTHÅFILESÅ&ÅSCREENSÅ(Å131Å138)ˇÿ(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(Å8086ÅASSEMBLERÅ--ÅLOADÅSCREENóMVP-FORTH)¿16ÅLOADˇˇˇˇˇˇˇ(Å8086ÅASSEMBLERÅ---ÅERRORÅHANDLINGÅ&ÅSTARTÅLOADINGÉMVP-FORTH)ÅHEXº:Å-->ÅBLKÅ@Å.Ç?LOADINGÅ0Å>INÅ!Å1ÅBLKÅ+!Å;ÅIMMEDIATEÃ:Å?ERROR1ÅABORT"ÅADDRESSÅOUTÅOFÅRANGEÅ"Å;ó:Å?ERROR2ÅABORT"ÅIMMEDIATEÅDATAÅVALUEÅNOTÅALLOWEDÅ"Å;ã:Å?ERROR3ÅABORT"ÅILLEGALÅOPERANDÅ"Ç;õ:Å?ERROR4ÅABORT"ÅDESTINATIONÅADDRESSÅMISSINGÅ"Å;ê-->ˇˇˇˇÅ(Å8080ÅASSEMBLERÅ---ÅVARIABLESòMVP-FORTH)¿VOCABULARYÅASSEMBLERÅIMMEDIATEÑASSEMBLERÅDEFINITIONSÅHEX≈VARIABLEÅ<#>Ç0Å<#>Å!É(ÅIMMEDIATEÅDATAÅFLAGÅ)ëVARIABLEÅ<TD>Å0Å<TD>Å!Ç(ÅDESITNATIONÅOFÅADDRESSINGÅTYPEÅ)ÜVARIABLEÅ<TS>Å0Å<TS>Å!Ç(ÅSOURCEÅADDRESSINGÅTYPEÅ)éVARIABLEÅ<RD>Å0Å<RD>Å!Ç(ÅDESTINATIONÅREGISTERÇ)èVARIABLEÅ<RS>Å0Å<RS>Å!Ç(ÅSOURCEÅREGISTERÇ)îVARIABLEÅ<W>Ç0Å<W>Ç!Ç(ÅWORD/BYTEÅFLAGÇ)ïVARIABLEÅ<WD>Å0Å<WD>Å!Ç(ÅDESTINATIONÅWORD/BYTEÅFLAGÅ)äVARIABLEÅ<OD>Å0Å<OD>Å!Ç(ÅDESTINATIONÅOFFSETÇ)ëVARIABLEÅ<OS>Å0Å<OS>Å!Ç(ÅSOURCEÅOFFSETÅ)óVARIABLEÅ<D>Ç0Å<D>Ç!Ç(ÅDIRECTIONÅFLAGÅFORÅR/MÅ)éVARIABLEÅ<SP>Å0Å<SP>Å!Ç(ÅLOCALÅSTACKÅPOINTERÅ)ë-->Ω(Å8086ÅASSEMBLERÅ---ÅCASEÅSTATEMENTìMVP-FORTH)¿(ÅCASEÅSTATEMENTÅBYÅCHARLESEÅE.ÅEAKERÅ)ô(ÅFROMÅFORTHÅDIMENSIONS,ÅVOLUMEÅII,ÅNO.Å3,ÅPAGEÅ37Å)Ã:ÅCASEá?COMPÅCSPÅ@ÅSP@ÅCSPÅ!Ç4Å;ãIMMEDIATEÖ:ÅOFâ4Å?PAIRSÅCOMPILEÅOVERÅCOMPILEÅ=°COMPILEÅ0BRANCHÅHEREÅ0Å,®COMPILEÅDROPÅ5Å;ìIMMEDIATEá:ÅENDOFÜ5Å?PAIRSÅCOMPILEÅBRANCHÅHEREÅ0Å,†SWAPÅ2Å[COMPILE]ÅTHENÅ4Å;âIMMEDIATEà:ÅENDCASEÑ4Å?PAIRSÅCOMPILEÅDROP´BEGINÅSP@ÅCSPÅ@Å=Å0=¨WHILEÅ2Å[COMPILE]ÅTHEN™REPEATÅCSPÅ!Å;ïIMMEDIATEá-->Ω(Å8086ÅASSEMBLERÅ---ÅMISCELLANEOUSÅPRIMITIVESâMVP-FORTH)¿(ÅSAVEÅTHEÅCURRENTÅSTACKÅPOINTERÅASÅBASEÅOFÅLOCALÅSTACKÅ)á:Å!<SP>âSP@Å<SP>Å!Å;§(ÅRETURNÅNUMBERÅOFÅITEMSÅONÅLOCALÅSTACKÅ)ó:Å?<SP>â<SP>Å@ÅSP@Å-Å2Å-Å2/Å;õ-->ˇˇˇˇˇÇ(Å8086ÅASSEMBLERÅ---ÅDESTINATIONÅREGISTERÅPROCESSINGÇMVP-FORTH)¿:ÅDREGÉCREATEÅC,ÅC,ÅC,ã(ÅSTOREÅINPUTÅPARAMETER)çDOES>ªDUPÅC@ÅDUPÅ0FFÅ=å(ÅWORD/BYTEÅFLADÅ)îIFÅDROPÅELSEÅDUPÅ<W>Å!Å<WD>Å!ÅTHENú1+ÅDUPÅC@Å<TD>Å!å(ÅADDRESSINGÅTYPEÅ)ë1+ÅC@Å<RD>Å!ê(ÅGETÅREGISTERÅCODEÅ)è<#>Å@Å?ERROR2≥<TD>Å@Å4Å=í(ÅINDEXEDÅADDRESSINGÅ?Å)éIFÅ?<SP>É0Å>å(ÅYES,ÅANYÅDISPLACEMENT?Å)éIFÅ<OD>Å!ÅTHENä(ÅSAVEÅDISPLACEMENTÅ)ëTHENÉ;ˇØ-->Ω(Å8086ÅASSEMBLERÅ---ÅSOURCEÅREGISTERÅPROCESSINGáMVP-FORTH)¿:ÅSREGÇCREATEÅC,ÅC,ÅC,ç(ÅSTOREÅINPUTÅPARAMETERSÅ)äDOES>ªDUPÅC@ÅDUPÅ0FFÅ=å(ÅWORD/BYTEÅFLAGÅ)îIFÅDROPÅELSEÅ<W>Å!ÅTHENß1+ÅDUPÅC@Å<TS>Å!å(ÅADDRESSINGÅTYPEÇ)ê1+ÅC@Å<RS>Å!ê(ÅSETÅREGISTERÅCODEÅ)è<TS>Ç@Å4Å=ë(ÅINDEXEDÅADDRESSING?Å)èIFÅ?<SP>Å0Å>é(ÅYES,ÅANYÅDISPLACEMENT?Å)éIFÅ<OS>Å!ÅTHENä(ÅSAVEÅDISPLACEMENTÅ)ëTHENÇ;Ø-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅSOURCEÅREGISTERÅDEFINITIONSÜMVP-FORTH)¿(ÅREGÑTYPEÑWåNAMEÇ)ﬁ0Ü2Ü0ÑSREGÖAL¢1Ü2Ü0ÑSREGÖCL¢2Ü2Ü0ÑSREGÖDL¢3Ü2Ü0ÑSREGÖBL¢4Ü2Ü0ÑSREGÖAH¢5Ü2Ü0ÑSREGÖCH¢6Ü2Ü0ÑSREGÖDH¢7Ü2Ü0ÑSREGÖBHü-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅSOURCEÅREGISTERÅDEFINITIONSÜMVP-FORTH)¿(ÅREGÉTYPEÑWäNAMEÅ)‚0Ö3Ü1ÉSREGÑAX•1Ö3Ü1ÉSREGÑCX•2Ö3Ü1ÉSREGÑDX•3Ö3Ü1ÉSREGÑBX•4Ö3Ü1ÉSREGÑSP•5Ö3Ü1ÉSREGÑBP•6Ö3Ü1ÉSREGÑSI•7Ö3Ü1ÉSREGÑDI¢-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅSOURCEÅREGISTERÅDEFINITIONSÜMVP-FORTH)¿(ÅREGÉTYPEÑWäNAMEÅ)¢0Ö4Ö-1ÉSREGÉ[BX+SI]°0Ö4Ö-1ÉSREGÉ[SI+BX]°1Ö4Ö-1ÉSREGÉ[BX+DI]°1Ö4Ö-1ÉSREGÉ[DI+BX]°2Ö4Ö-1ÉSREGÉ[BP+SI]°2Ö4Ö-1ÉSREGÉ[SI+BP]°3Ö4Ö-1ÉSREGÉ[BP+DI]°3Ö4Ö-1ÉSREGÉ[DI+BP]°4Ö4Ö-1ÉSREGÉ[SI]§5Ö4Ö-1ÉSREGÉ[DI]§6Ö4Ö-1ÉSREGÉ[BP]§7Ö4Ö-1ÉSREGÉ[BX]°-->Ω(Å8086ÅASSEMBLERÅ---ÅSEGMENTÅREGISTERÅDEFINITIONSÖMVP-FORTH)¿(ÅREGÉTYPEÉWäNAMEÅ)„0Ö5Ñ-1ÉSREGÑES¶1Ö5Ñ-1ÉSREGÑCS¶2Ö5Ñ-1ÉSREGÑSS¶3Ö5Ñ-1ÉSREGÑDSÊ0Ö5Ñ-1ÉDREGÑES,•1Ö5Ñ-1ÉDREGÑCS,•2Ö5Ñ-1ÉDREGÑSS,•3Ö5Ñ-1ÉDREGÑDS,¢-->ˇæ(Å8086ÅASSEMBLERÅ---ÅDESTINATIONÅREGISTERÅDEFINITIONSÅMVP-FORTH)¿(ÅREGÉTYPEÑWäNAMEÅ)‚0Ö2Ü0ÉDREGÑAL,§1Ö2Ü0ÉDREGÑCL,§2Ö2Ü0ÉDREGÑDL,§3Ö2Ü0ÉDREGÑBL,§4Ö2Ü0ÉDREGÑAH,§5Ö2Ü0ÉDREGÑCH,§6Ö2Ü0ÉDREGÑDH,§7Ö2Ü0ÉDREGÑBH,°-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅDESTINATIONÅREGISTERÅDEFINITIONSÅMVP-FORTH)¿(ÅREGÉTYPEÖWäNAMEÅ)·0Ö3á1ÉDREGÑAX,£1Ö3á1ÉDREGÑCX,£2Ö3á1ÉDREGÑDX,£3Ö3á1ÉDREGÑBX,£4Ö3á1ÉDREGÑSP,£5Ö3á1ÉDREGÑBP,£6Ö3á1ÉDREGÑSI,£7Ö3á1ÉDREGÑDI,†-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅDESITNATIONÅREGISTERÅDEFINITIONSÅMVP-FORTH)¿(ÅREGÉTYPEÖWäNAMEÖ)ù0Ö4Ü-1ÉDREGÉ[BX+SI],ü0Ö4Ü-1ÉDREGÉ[SI+BX],ü1Ö4Ü-1ÉDREGÉ[BX+DI],ü1Ö4Ü-1ÉDREGÉ[DI+BX],ü2Ö4Ü-1ÉDREGÉ[BP+SI],ü2Ö4Ü-1ÉDREGÉ[SI+BP],ü3Ö4Ü-1ÉDREGÉ[BP+DI],ü3Ö4Ü-1ÉDREGÉ[DI+BP],ü4Ö4Ü-1ÉDREGÉ[SI],¢5Ö4Ü-1ÉDREGÉ[DI],¢6Ö4Ü-1ÉDREGÉ[BP],¢7Ö4Ü-1ÉDREGÉ[BX],ü-->Ω(Å8086ÅASSEMBLERÅ---ÅMISCELLANEOUSÅOPERATORSäMVP-FORTH):Å?Wà<W>Å@Å;í(ÅFETCHÅWORD/BUTEÅFLAGÅ)É:Å?TDá<TD>Å@Å;ë(ÅFETCHÅDESTÅADDRÅTYPEÅ)É:Å?TSá<TS>Å@Å;ë(ÅSOURCEÅADDRÅTYPEÖ)É:Å?RDá<RD>Å@Å;ë(ÅDESTÅREGISTERÅCODEÉ)É:Å?RSá<RS>Å@Å;ë(ÅSOURCEÅREGISTERÅCODEÅ)É:Å?ODá<OD>Å@Å;ë(ÅDESTÅDISPLACEMENTÑ)É:Å?OSá<OS>Å@Å;ë(ÅSOURCEÅDISPLACEMENTÇ)É:Å+Dà<D>Å@Å2*Å+Å;ç(ÅMERGEÅDIRECTIONÅFLAGÅ)É:Å+Wà<W>Å@Å+Å;ê(ÅMERGEÅWORD/BYTEÅFLAGÅ)É:Å+RDá<RD>Å@Å+Å;è(ÅMERGEÅDESTÅREGÅCODEÇ)É:Å+RSá<RS>Å@Å+Å;è(ÅMERGEÅSOOUREÅREGÅCODE)É:ÅMOD1Ü3FÅANDÅ040ÅORÅ;ä(ÅSETMODÅFIELDÅTOÅ01É)É:ÅMOD2Ü3FÅANDÅ080ÅORÅ;ä(ÅSETMODÅFIELDÅTOÅ10É)É:ÅMOD3Ü3FÅANDÅ0C0ÅORÅ;ä(ÅSETMODÅFIELDÅTOÅ11É)É-->Ω(Å8086ÅASSEMBLERÅ---ÅMISCELLANEOUSÅOPERATORSäMVP-FORTH)¿(ÅEQUATESÅTOÅADDRESSINGÅMODESÉ)ü0ÅCONSTANTÅDIRECTã3ÅCONSTANTÅREG16î1ÅCONSTANTÅIMMEDå4ÅCONSTANTÅINDEXEDí2ÅCONSTANTÅREG8ç5ÅCONSTANTÅSEGREG”(ÅINITIALIZEÅALLÅVARIABLESÅANDÅFLAGSÇ)ô:ÅRESETÉ0Å<#>Å!Ö0Å<W>Å!Ü0Å<OS>Å!Ü0Å<RD>Å!ë0Å<TD>Å!Ñ0Å<TS>Å!Ö0Å<OD>Å!Ü!<SP>î0Å<D>Å!Ö0Å<WD>Å!Ö0Å<RS>Å!É;ë(ÅINITIALIZEÅDIRECTIONÅPOINTERÅFORÅMEM/REGÅINSTRUCTIONSÅ)á:ÅDSETÑ?TSÅINDEXEDÅ=Å<D>Å!Å;°(ÅSETÅTHEÅDIRECTIONÅFLAGÅTRUEÇ)†:ÅDTÜ1Å<D>Å!Å;≠-->Ω(Å8086ÅASSEMBLERÅ---ÅMISCELLANEOUSÅOPERATORSäMVP-FORTH)(ÅCALCULATEÅANDÅSTOREÅRELATIVEÅOFFSETÅFORÅBRANCHESÅANDÅLOOPSÅ)Ç:ÅOFFSET8,Ç(ÅISSUEÅERRORÅMESSAGEÅIFÅDARGETÅOUTÅOFÅADDRÅRANGEÅ)ÑHEREÅ1+Å-ÅDUPÅABSÅ07FÅ>Å?ERROR1ÉC,Å;ó(ÅCALCULATEÅANDÅSTOREÅ16ÅBITÅOFFSETÅFORÅJMPÅANDÅCALLÅ)ä:ÅOFFSET16,ÇHEREÅ2+Å-Å,Å;¶(ÅCALCULATEÅANDÅSTOREÅDISPLACEMENTÅFORÅMEM/REGÅINSTRUCTIONSÅ)É:ÅDISP,Ç<D>Å@ÅIFÅ?OSÅELSEÅ?ODÅTHENÅDUPÇ(ÅGETÅDISPLÇ)íIFÇDUPÅABSÅ07FÅ>è(ÅCHECKÅSIZEÅ)îIFÅSWAPÅMOD2ÅC,ÅCç(ÅTWOÅBYTESÇ)îELSEÅSWAPÅMOD1ÅC,ÅC,ÅTHENÖ(ÅONEÅBYTEÉ)íELSEÅDROPÅDUPÅ7ÅANDÅ6Å=â(ÅNOÅDISPLÉ)îIFÅMOD1ÅC,Å0ÅC,è(ÅEXCEPTÅ[BP])îELSEÅC,ÅTHENí(ÅALWAYSÅGETS)íTHENÇ;∞-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGRÅ1-3ÉMVP-FORTH)¿(ÅSINGLEÅBYTEÅINSTRUCTIONSÅWITHOUTÅOPERANDSÅ)ì:Å1MIÇCREATEÉC,µDOES>ÑC@ÅC,ÅRESETÅ;„(ÅCONDITIONALÅJUMPSÅANDÅLOOPS,Å1ÅBYTEÅ+ÅOFFSETÇ)è:Å2MIÇCREATEÉC,µDOES>ÑC@ÅC,ÅOFFSET8,ÅRESETÅ;⁄(ÅSTRINGÅINSTRUCTIONSÇ)®:Å3MIÇCREATEÉC,µDOES>ÑC@Å+WÅC,ÅRESETÅ;†-->ˇæ(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ4ÇMVP-FORTH)¿(ÅREGISTERÅPUSHÅANDÅPOPÉ)•:Å4MIÉCREATEÉC,ÅC,≤DOES>Ω?TS†(ÅOPERANDÅTYPEÉ)ãCASEºREG16ÑOFÇ1+ÅC@Å+RSÅC,ÅENDOFÑ(ÅUSUALÅ16ÅBITÅREG)äSEGREGÉOFÇC@Å?RSÅ8Å*Å+ÅC,ÅENDOFÅ(ÅSEGMENTÅREGÖ)ä1Ç?ERROR3∂ENDCASEÉRESETÇ;§-->ˇˇø(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ5ÇMVP-FORTH)¿(ÅINTRASEGMENTÅJMPÅANDÅCALL,Å16ÅBITÅOFFSETÅORÅREG/MENÇ)à(ÅINTERSEGMENTÅLONGÅJMPSÅANDÅTHEÅSHORTÅJMPÅAREÅNOTÅSUPPORTEDÅ)Ç:Å5MIÅCREATEÅC,ÅC,¥DOES>Ω?TS¢(ÅOPERANTÅTYPEÅ)ãCASEºDIRECTÉOFÇ1+ÅC@ÅC,ÅOFFSET16,àENDOFÅ(ÅDISPÅ16)âREG16ÑOFÇ0FFÅC,ÅC@ÅMOD3Å+RSÅC,ÖENDOFÅ(ÅVIAÅREG)âINDEXEDÇOFÇDSETÅ0FFÅC,ÅC@Å+RSÅDISP,ÇENDOFÅ(ÅINDEXED)â1Ç?ERROR3∂ENDCASEÇRESETÇ;ß-->ˇæ(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ6ÇMVP-FORTH)¿(ÅINÅANDÅOUTÉ)∞:Å6MIÉCREATEÇC,ÅC,≥DOES>ë(ÅINÅORÅOUTÅ?ê)éDUPÅC@Å2ÅANDà(ÅIFÅTRUEÅISÅOUTÅINSTRá)éIFÑ?TDÉ?TSÖ(ÅGETÅOPERANDÅTYPESä)éELSEÇ?TSÉ?TDÖ(ÅTOSÅ=ÅDATAÅWIDTHã)éTHENê(ÅNOSÅ=ÅPORTÅADDRÅTYPEá)éREG16Å=Å<W>Å!á(ÅSETÅWORD/BYTEÅTRANSFERÖ)éREG16Å=ç(ÅCHECKÅIFÅREGISTERÅADDRÖ)éIFÖ1+ÅC@Å+WÅC,Ç(ÅVIAÅDXï)éELSEÉC@Å+WÅC,ÅC,Ç(ÅVIAÅINLINEÅPORTÅ#ä)éTHENÇRESETÇ;®-->˝(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ7ÇMVP-FORTH)¿(ÅADC,ÅADD,ÅAND,ÅCMP,ÅOR,ÅSBB,ÅSUB,ÅANDÅXORã)â:Å7MIÉCREATEÅC,ÅC,ÅC,±DOES>Ω?TSÅIMMEDÅ=å(ÅSOURCEÅ=ÅIMMEDIATEÅDATAÅ)éIFÇ1+ÅDUPÅ1+ÅC@Å+WÅC,¨?TDÅCASEç(ÅCHECKÅDESTÅTYPEâ)êREG8ÑOFÇC@ÅMOD3Å+RDÅC,ÅC,ÑENDOFöREG16ÉOFÇC@ÅMOD3Å+RDÅC,Å,ÖENDOFöINDEXEDÅOFÅDSETÅC@Å+RDÅDISP,¶?WÅIFÅ,ÅELSEÅC,ÅTHENãENDOFö1ÅABORT"ÅILLEGALÅOPERAND"ÜENDCASEòELSEÅDSETÅC@Å+DÅ+WÅC,Ç(ÅSOURCEÅ=ÅREG/MEMá)ë?TDÅCASEç(ÅCHECKÅDESTÅTYPEà)Ö-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ7ÅCONTÑMVP-FORTH)ÀREG8ÖOFÅ?TSÅCASEã(Å8ÅBITÅDESTÅREGÖ)çREG8ÅOFÅ?RSÅ8Å*Å+RDÅMOD3ÅC,ÇENDOFÅ(Å8ÅBITÅSOURCEÅ)çINDEXEDÅOFÅ?RDÅ8Å*Å+RSÅDISP,ÅENDOFÅ(ÅINDEXEDÅSOURC)ç1Ç?ERROR3ÇENDCASEÉENDOF£REG16ÑOFÅ?TSÅCASEã(Å16ÅBITÅDESTÅREGÑ)çREG16ÑOFÅ?RSÅ8Å*Å+RDÅMOD3ÅC,ÅENDOFÅ(Å16ÅBITÅSRC)çINDEXEDÇOFÅ?RDÅ8Å*Å+RSÅDISP,ÉENDOFÅ(ÅINDEXEDÉ)ç1Ç?ERROR3ÅENDCASEÉENDOF§INDEXEDÇOFÅ?TSÅCASEã(ÅINDEXEDÅDESTá)çREG8ÉOFÅ?RSÅ8Å*Å+RDÅDISP,ÇENDOFÑ(Å8ÅBITÅSRCÅ)çREG16ÇOFÅ?RSÅ8Å*Å+RDÅDISP,ÇENDOFÑ(Å16ÅBITÅSRC)ç1Å?ERROR3ÅENDCASEÉENDOF¶1Ç?ERROR3ÇENDCASEÅTHENÅRESETÅ;î-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ8ÇMVP-FORTH)¿(ÅDIV,ÅIDIV,ÅIMUL,ÅMUL,ÅNEG,ÅANDÅNOTÖ)ñ:Å8MIÉCREATEÅC,ÅC,¥DOES>ΩDUPÅ1+ÅC@Å+WÅC,±?TSÇCASEù(ÅOPERANDÅTYPEÅ)äREG8ÑOFÇC@Å+RSÅMOD3ÅC,ÜENDOFÅ(Å8ÅBITÅREGÑ)äREG16ÉOFÇC@Å+RSÅMOD3ÅC,ÜENDOFÅ(Å16ÅBITÅREGÉ)äINDEXEDÅOFÇDSETÅC@Å+RSÅDISP,ÉENDOFÅ(ÅINDEXEDÜ)ä1Å?ERROR3∑ENDCASEÅRESETÅ;ß-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ9ÇMVP-FORTH)¿(ÅVARIOUSÅSHIFÅINSTRUCTIONSÖ)ü:Å9MIÉCREATEÅC,ÅC,¥DOES>ΩDUPÅ1+ÅC@Å<WD>Å@Å+á(ÅWORD/BYTEÅFLAGEâ)å?TSÅ1Å>ÅIFÅ2+ÅTHENÅC,Ñ(ÅSHIFÅ1ÅORÅCOUNTÅINÅCL?Ç)å?TDÅCASEë(ÅOPERANDÅTOÅBEÅSHIFTEDÉ)åREG8ÑOFÉC@ÅMOD3Å+RDÅC,ÉENDOFÑ(Å8ÅBITÅREGÅ)åREG16ÉOFÉC@ÅMOD3Å+RDÅC,ÉENDOFÑ(Å16ÅBITÅREG)åINDEXEDÅOFÉDSETÅC@Å+RDÅDISP,ÅENDOFÉ(ÅINDEXEDÉ)å1Å?ERROR3∑ENDCASEπ?TSÅ2Å<ÅIFÅDROPÅTHENÅRESETÅ;Å(ÅCLEANÅUPÅSTACKÜ)Ç-->˝(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ10ÅMVP-FORTH)¿(Å2ÅBYTEÅSIMPLEÅINSTRUCTIONSÅWITHOUTÅOPERANDSÇ)–:Å10MIÉCREATEÉC,ÅC,≤DOES>ÑDUPÅC@ÅSWAPÅ1+ÅC@ÅC,ÅC,ÅRESETÅ;è-->ˇˇˇˇˇÇ(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ11ÅMVP-FORTH)¿(ÅINCÅANDÅDECÅINSTRUCTIONSÅ)§:Å11MIÉCREATEÅC,ÅC,¥DOES>Å?TSÅCASEò(ÅOPERANDÅTYPEÅ)äREG8ÖOFÇ0FEÅC,Å1+ÅC@¥MOD3Ç+RSÅC,áENDOFÅ(Å8ÅBITÅREGÑ)äREG16ÑOFÇC@Å+RSÅC,äENDOFÅ(Å16ÅBITÅREGÉ)äINDEXEDÇOFÇDSETÅ0FEÅ+WÅC,≤1+ÅC@Å+RSÅDISP,ÑENDOFÅ(ÅINDEXEDÜ)ä1Å?ERROR3∑ENDCASEÅRESETÅ;®-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCERSSING,ÅGROUPÅ12áMVP-FORTH)¿(ÅMOVÅINSTRUCTIONSÅREG/REG,ÅREG/MEM,ÅORÅREG/IMMEDIATEÜ)Ñ:Å12MIÅCREATE∫DOES>ÅDROPÅDSETÅ?TDÅCASE®DIRECTÇOFÇ?TSÅCASEÑ(ÅDISTINATIONÅ=ÅMEMORYÅDIRECTÇ)ä(ÅSOURCEÅ=Å8ÅBITÅGENERALÅREGISTERÉ)õREG8ÖOFÅ?RSÅIFÅ088ÅC,Å?RSÅ8Å*Å6Å+ÅC,Å,É(ÅREGÉ)ïELSEÅ0A2Å+WÅC,Å,ÅTHENÜENDOFÅ(ÅACCÉ)ã(ÅSOURCEÅ+Å16ÅBITÅGENERALÅREGISTERÉ)öREG16ÑOFÅ?RSÅIFÅ089ÅC,Å?RSÅ8Å*Å6Å+ÅC,Å,Å(ÅREGÉ)òELSEÅ0A2Å+WÅC,Å,ÅTHENÑENDOFÅ(ÅACCÉ)å(ÅSOURCEÅ+ÅSEGMENTÅREGISTERÇ)¢SEGREGÉOFÅ08CÅC,Å?RSÅ8Å*Å6Å+ÅC,Å,ÇENDOFñ1Å?ERROR3ÉENDCASEÑENDOFõ-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ12ÅCONTÉMVP-FORTH)«REG8ÉOFÇ?TSÅCASEÅ(ÅDESTINATIONÅ+Å8ÅBITÅGENERALÅREGÉ)â(ÅSOURCEÅ=ÅMEMORYÅDIRECTÖ)¢DIRECTÅOFÇ?RDÅIFÅ08AÅC,Å?RDÅ8Å*Å6Å+ÅC,Å,ôELSEÅ0A0Å+WÅC,Å,ÑTHENèENDOFí(ÅSOURCEÅ=ÅIMMEDIATEÅDATAÇ)§IMMEDÇOFÇ0B0Å+RDÅC,ÅC,ëENDOFí(ÅSOURCEÅ=Å8ÅBITÅGENERALÅREGÉ)†REG8ÇOFÅDTÅ88Å+DÅC,Å?RDÅ8Å*Å+RSÅMOD3ÅC,ÅENDOFíREG16ÅOFÇ1ÅABORT"ÅREGISTERÅMISMATCH"ÑENDOFí(ÅSOURCEÅ=ÅINDEXEDÅADDRESSÉ)¢INDEXEDÅOFÅ88Å+DÅ+WÅC,Å?RDÅ8Å*Å+RSÅDISP,ÅENDOFí1Å?ERROR3ÜENDCASEáENDOFï-->˝(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ12ÅCONTÉMVP-FORTH)àREG16ÅOFÅ?TSÅCASEÇ(ÅDESTINATIONÅ+Å16ÅBITÅGENERALÅREGÇ)ä(ÅSOURCEÅ=ÅMEMORYÅDIRECTÅ)¶DIRECTÅOFÅ?RDÅIFÅ08BÅC,Å?RDÅ8Å*Å6Å+ÅC,Å,öELSEÅ0A0Å+WÅC,Å,ÖTHENíENDOFé(ÅSOURCEÅ=ÅIMMEDIATEÅDATEÉ)£IMMEDÅOFÇ0B8Å+RDÅC,Å,óENDOFé(ÅSOURCEÅ=Å16ÅBITÅGENERALÅREGÇ)†REG16ÇOFÅDTÅ88Å+WÅ+DÅC,Å?RDÅ8Å*Å+RSÅMOD3ÅC,ÅENDOFé(ÅSOURCEÅ=ÅINDEXEDÅADDRESSÇ)£INDEXEDÇOFÅ88Å+DÅ+WÅC,Å?RDÅ8Å*Å+RSÅDISP,ÑENDOFé(ÅSOURCEÅ=ÅSEGMENTÅREGISTERÉ)°SEGREGÅOFÅ8CÅC,Å?RSÅ8Å*Å+RDÅMOD3ÅC,äENDOFé1Å?ERROR3éENDCASEÇENDOFë-->˝(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ12ÅCONTÉMVP-FORTH)»INDEXEDÅOFÅ?TSÅCASEÇ(ÅDESTINATIONÅ+ÅINDEXEDÅADDRESSé(ÅSOURCEÅ=ÅIMMEDIATEÅDATEÖ)°IMMEDÇOFÇ0C6Å+WÅC,Å?RDÅDISP,§?WÅIFÅ,ÅELSEÅC,ÅTHENòENDOFç(ÅSOURCEÅ=Å8ÅBITÅGENERALÅREGÉ)†REG8ÇOFÇ88Å+DÅ+WÅC,Å?RSÅ8Å*Å+RDÅDISP,áENDOFç(ÅSOURCEÅ=Å16ÅBITÅGENERALÅREGÉ)üREG16ÅOFÇ88Å+DÅ+WÅC,Å?RSÅ8Å*Å+RDÅDISP,áENDOFç(ÅSOURCEÅ=ÅSEGMENTÅREGISTERÇ)¢SEGREGÅOFÇ08CÅC,Å?RSÅ8Å*Å+RDÅDISP,ãENDOFç1Ç?ERROR3èENDCASEÇENDOFè-->ˇæ(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ12ÅCONTÉMVP-FORTH)«SEGREGÇOFÇ?TSÅCASEÇ(ÅDESTINATIONÅ+ÅSEGMENTÅREGISTER)ã(ÅSOURCEÅ=ÅMEMORYÅDIRECTÉ)§DIRECTÇOFÇ08EÅC,Å?RDÅ8Å*Å6Å+ÅC,Å,äENDOFé(ÅSOURCEÅ=Å16ÅBITÅGENERALÅREGISTERÉ)öREG16ÇOFÇ08EÅC,Ç?RDÅ8Å*Å+RSÅMOD3ÅC,áENDOFé(ÅSOURCEÅ=ÅINDEXEDÅADDRESSINGÇ)†INDEXEDÅOFÇ08EÅC,Å?RDÅ8Å*Å+RSÅDISP,âENDOFé1Å?ERROR3üENDCASEÅENDOF…1Å?ERROR3úENDCASEÑRESETÅ;Ç-->ˇ˛(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅPROCESSING,ÅGROUPÅ13ÅMVP-FORTH)¿(ÅXCHGÅINSTRUCTIONSÑ)®:Å13MIÇCREATE∫DOES>ÅDROPÅDSETÅ?TDÇCASEá(ÅDESTINATIONÅTYPEÅ?Ç)â(ÅIFÅMISSINGÅDSTÅREGÅASSUMEÅ16ÅBITÅREGÅ<->ÅACCÅ)êDIRECTÇOFÅ?TSÇREG16Å=´IFÅ90Å+RSÅC,ÅELSEÅ1ÅABORT"ÅILLEGALÅOPERAND"ÅTHENÅENDOFä(ÅEXCHANGEÅOFÅ8ÅBITÅREGISTERÅWITHÅREGÅORÅMEMORYÉ)çREG8ÇOFÇ86Å+WÅC,Ç?TSÅCASEÉ(ÅSOURCEÅTYPE?É)ëREG8ÖOFÅ?RDÅ8Å*Å+RSÅMOD3ÅC,áENDOFïINDEXEDÇOFÅ?RDÅ8Å*Å+RSÅDISP,âENDOFï1Å?ERROR3öENDCASEÉENDOFÇ-->ˇæ(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ13ÅCONTÉMVP-FORTH)»(ÅEXCHANGEÅ16ÅBITÅREGISTERÅWITHÅREGISTERÅORÅMEMORYÇ)ãREG16ÇOFÇ86Å+WÅC,Å?TSÅCASE¶REG16ÑOFÇ?RDÅ8Å*Å+RSÅMOD3ÅC,ãENDOFêINDEXEDÇOFÇ?RDÅ8Å*Å+RSÅDISP,çENDOFê1Å?ERROR3öENDCASEÅENDOFŒ1Å?ERROR3íENDCASEÑRESETÅ;ã-->ˇˇˇ¿(Å8086ÅASSEMBLERÅ---ÅINSTÅPROCESSING,ÅGROUPÅ14Å&Å15ÉMVP-FORTH)(ÅSPECIALÅROUTINEÅFORÅTESTÅINSTRUCTIONÅ)ò:Å14MIÅCREATEÅDOES>ÅDROPÅ?TSÅCASE¢DIRECTÇOFÅ1ÅABORT"ÅILLEGALÅOPERAND"ÅENDOFÅ(ÅDIRÅADDÅILLEAL)ÉIMMEDÉOFÅ0F6Å+WÅC,Å?TDÅCASEÜ(ÅIMMEDIATEÅTESTÅDATAÑ)ÖREG8ÑOFÅ?RDÅMOD3ÅC,Å?WÅIFÅ,ÅELSEÅC,ÅTHENÉENDOFçREG16ÉOFÅ?RDÅMOD3ÅC,Å?WÅIFÅ,ÅELSEÅC,ÅTHENÉENDOFçINDEXEDÅOFÅ?RDÅDISP,Å?WÅIFÅ,ÅELSEÅC,ÅTHENÖENDOFç1Å?ERROR3ùENDCASEÅENDOFãSEGREGÇOFÅ1Å?ERROR3ÇENDOFé(ÅSEGÅREGÅILLEGALÅ)Ñ?TDÅREG8Å<Å?TDÅREG16Å>ÅORÇ?ERROR3†84Å+WÅC,Å?RDÅ8Å*Å+RSÜ(ÅTESTÅREGÅWITHÅREB/MEMÅ)ç?TSÅINDEXEDÅ<ÅIFÅMOD3ÅC,Ç(ÅSOURCEÅ=ÅGENERALÅREGÇ)èELSEÅDISP,ÇTHENà(ÅSOURCEÅ=ÅINDEXEDÜ)çENDCASEÖRESETÇ;®:Ç15MIÉCREATEÅDOES>ÅDROPÅ0CDÅC,ÅC,ÅRESETÅ;Å-->è(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅDEFINITIONSäMVP-FORTH)¿37á1MIÑAAAä80Å38Å38Å7MIÑCMPêD5Å0AÑ10MIÉAADäA6á3MIÑCMPSèD4Å0AÑ10MIÉAAMä99á1MIÑCWDê3Fá1MIÑAASä27á1MIÑDAAê80Å10Å10Å7MIÑADCä2Fá1MIÑDASê80Å00Å00Å7MIÑADDä08Å48Ñ11MIÉDECê80Å20Å20Å7MIÑANDäF6Å30Ñ8MIÑDIVêE8Å10Ñ5MIÑCALLó(ÅESCÅ)é98á1MIÑCBWäF4á1MIÑHLTêF8á1MIÑCLCäF6Å38Ñ8MIÑIDIVèFCá1MIÑCLDäF6Å28Ñ8MIÑIMULèFAá1MIÑCLIäECÅE4Ñ6MIÑINëF5á1MIÑCMCä00Å40Ñ11MIÉINCê-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅDEFINITIONSäMVP-FORTH)»15MIÑINTãE9Å20Ñ5MIÑJMPèCEá1MIÑINTOä76á2MIÑJNAèCFá1MIÑIRETä72á2MIÑJNAEé77á2MIÑJAå73á2MIÑJNBè73á2MIÑJAEã77á2MIÑJNBEé72á2MIÑJBå75á2MIÑJNEè76á2MIÑJBEã7Eá2MIÑJNGèE3á2MIÑJCXYä7Cá2MIÑJNGEé74á2MIÑJEå7Dá2MIÑJNLè7Fá2MIÑJGå7Fá2MIÑJNLEé7Dá2MIÑJGEã71á2MIÑJNOè7Cá2MIÑJLå7Bá2MIÑJNPè7Eá2MIÑJLEã79á2MIÑJNSè-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅDEFINITIONSäMVP-FORTH)¿75á2MIÑJNZãE2á2MIÑLOOPé70á2MIÑJOåE1á2MIÑLOOPEç7Aá2MIÑJPåE0á2MIÑLOOPNEå7Aá2MIÑJPEãE0á2MIÑLOOPNZå7Bá2MIÑJPOãE1á2MIÑLOOPZç7Bá2MIÑJSï12MIÉMOVè74á2MIÑJZåA4á3MIÑMOVSé9Fá1MIÑLAHFäF6Å20Ñ8MIÑMULù(ÅLDSÅ)âF6Å18Ñ8MIÑNEGè8AÅ8AÅ8AÅ7MIÑLEAã90á1MIÑNOPù(ÅLESÅ)âF6Å10Ñ8MIÑNOTèF0á1MIÑLOCKä80Å08Å08Å7MIÑORêACá3MIÑLODSäEEÅE6Ñ6MIÑOUTè-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅDEFINITIONSäMVP-FORTH)¿58Å07Ñ4MIÑPOPãD0Å08Ñ9MIÑRORè9Dá1MIÑPOPFä9Eá1MIÑSAHFé50Å06Ñ4MIÑPUSHäD0Å38Ñ9MIÑSARè9Cá1MIÑPUSHFâ80Å18Å18Å7MIÑSBBèD0Å10Ñ9MIÑRCLãAEá3MIÑSCASéD0Å18Ñ9MIÑRCRô(ÅSEGÅ)çF3á1MIÑREPãD0Å20Ñ9MIÑSALèF3á1MIÑREPEäD0Å20Ñ9MIÑSHLèF2á1MIÑREPNEâD0Å28Ñ9MIÑSHRèF2á1MIÑREFNZâF9á1MIÑSTCèF3á1MIÑREPZäFDá1MIÑSTDèC3á1MIÑRETãFBá1MIÑSTIèD0Å00Ñ9MIÑROLãAAá3MIÑSTOSé-->Ω(Å8086ÅASSEMBLERÅ---ÅINSTRUCTIONÅDEFINITIONSäMVP-FORTH)¿80Å28Å28Å7MIÑSUB∂14MIÉTEST¨9Bá1MIÑWAITµ13MIÉXCHG¨D7á1MIÑXLAT¨80Å30Å30Å7MIÑXOR≠-->ˇˇˇˇÅ(Å8086ÅASSEMBLERÅ---ÅCONTROLÅSTRUCTURESèMVP-FORTH)(ÅIFÅ...ÅTHENÇORÇIFÅ...ÅELSEÅ...ÅTHENÇPROVIDESÅCONDITIONALÇ)(ÅEXECUTIONÅBASEDÅONÅTHEÅSTATÅOFÅTHEÅCPU'SÅZÅFLAGé):ÅIFÖ074ÅC,Å0ÅC,ÅHEREÅRESETÅ;Ü(ÅSTORESÅJZç):ÅELSEÉ0EBÅC,Å0ÅC,ÅDUPè(ÅSTORESÅJMPå)ÉHEREÅSWAPÅ-ÅDUPÅABSÅ07FÅ>Å?ERROR1üSWAPÅ1-ÅC!ÅHEREÅRESETÅ;¶:ÅENDIFÇDUPÅHEREÅSWAPÅ-ÅDUPÅABSÅ07FÅ>Å?ERROR3ïSWAPÅ1-ÅC!ÅRESETÅ;í(ÅRESOLVESÅBRANCHESÖ)¿(ÅBEGINÅ...ÅUNTILÉCONSTRUCTÅPROVIDESÅCONTROLLEDÅREPETITIVEÉ)(ÅEXECUTION,ÅEXITÅFROMÅLOOPÅTAKENÅIFÅZÅFLAGÅISÅFALSE.ä):ÅBEGINÉHEREÇRESETÅ;ê(ÅLEAVESÅADDRESSà):ÅUNTILÉ074ÅC,ÅHEREÅ1+Å-ç(ÅSTORESÅJZç)äDUPÅABSÅ07FÅ>Å?ERROR3ÅC,ÅRESETÅ;ñ-->Ω(Å8086ÅASSEMBLERÅ---ÅSPECIALÅOPERATORSêMVP-FORTH)¿(ÅFORCEÅBYTEÅADRESSINGÅMODEÖ)ü:ÅBYTEÑ0Å<W>Å!Ñ0Å<WD>Å!Å;·(ÅFORCEÅWORDÅADRESSINGÅMODEÉ)°:ÅWORDÑ1Å<W>Å!Ñ1Å<WD>Å!Å;·(ÅSETÅIMMEDIATEÅDATAÅFLAGÇ)§:Å#á1Å<#>Å!Ñ1Å<TS>Å!Å;·(ÅCOMMAÅDELIMITSÅDESTINATIONÅFIELDÅFORÅDIRECTÅADDRESSINGÖ)Ç:Å,áDEPTHÅ1Å<Å?ERROR4Ø0Å<TD>Å!Å;¨-->˝(Å8086ÅASSEMBLERÅ---ÅLOADINGÅTERMINATIONéMVP-FORTH)¿(ÅEND-CODEÅCODE,Å:CODE,ÅANDÅNEXTÅDELIMITÅAÅCODEÅDEFINITIONÑ)Å:ÅEND-CODEÉCURRENTÅ@ÅCONTEXTÅ!ÅSP@Å2+Å=ÅFORTHîIFÅSMUDGEÅELSEÅ."ÅCODEÅERROR,ÅSTACKÅDEPTHÅCHANGEDÅ"ÅTHENÅ;√FORTHÅDEFINITIONSÅFORTH©:ÅENTERCODEÉ[COMPILE]ÅASSEMBLERÅSP@Å;ô:ÅCODEÉCREATEÅSMUDGEÅHEREÅDUPÅ2-Å!ÅENTERCODEÅ;ê:Å;CODEÇ?CSPÅCOMPILEÅ<;CODE>Å[COMPILE]Å[ÅENTERCODEÅ;ÅIMMEDIATE¡DECIMALπCRÅCRÅ."Å8086ÅAssemblerÅloaded.Å"ˇ‡(Å8086ÅASSEMBLERÅ---ÅLOADINGÅTERMINATIONéMVP-FORTH)¿(ÅCODE,Å:CODE,ÅANDÅNEXTÅDELIMITÅAÅCODEÅDEFINITIONÑ)ä:ÅNEXTÑ0E9ÅC,ÅNEXTÅOFFSET16,ÅRESET•?CSPÅSMUDGEÅ[COMPILE]ÅFORTHÅ;ÇIMMEDIATEŒFORTHÅDEFINITIONSØ:Å;CODEÉ?CSPÅCOMPILEÅ<;CODE>Å[COMPILE]Å[ÅASSEMBLERñRESETÅFORTHÅ[COMPILE]ÅASSEMBLERÅ;ÅIMMEDIATEã:ÅCODEÑSP@ÅCSPÅ!ÇCREATEÅASSEMBLERÇRESETÅFORTHò[COMPILE]ÅASSEMBLERÅ;ÜIMMEDIATE“DECIMALπCRÅCRÅ."Å8086ÅAssemblerÅloaded.Å"üEXIT¸(µMVP-FORTH)ˇˇˇˇˇˇˇ«(ÇLOADÅSCREENÅFORÅLINEÅEDITORòMVP-FORTH)ˇÅ61Å78ÅTHRUˇˇˇˇˇˇº(Ç<MATCH>¨MVP-FORTH)¡WARNINGÅ@Ç0ÅWARNINGÅ!È:Å<MATCH>Ö(ÅADDR-3,ÅADDR-2,ÅCOUNT-1Å---ÅFLAGÇ)è?DUPÇIFÅOVERÅ+ÅSWAPÆDO¿DUPÅC@ÅIÅC@Å-≥IFÅ0=ÇLEAVEÅELSEÅ1+ÇTHEN§LOOP∫ELSEÅDROPÅ0=ÇTHENÅ;ˇˇÏ(ÇMATCHÆMVP-FORTH)¿:ÅMATCHÑ(ÅCURSORÅADDR-4,ÅBYTESÅLEFT-3,ÅSTRINGÅADDR-2Å)í(ÅSTRINGÅCOUNT-1,Å---ÅFLAG-2,ÇCURSORÅOFFSET-1Å)á>RÇ>RÇDDUPÇR>ÅR>ÇDSWAPÇOVERÇ+ÇSWAPó(ÅCADDR-6,ÅBLEFT-5,Å$ADDR-4,Å$LEN-3,ÅCADDR+BLEFT-2,ÅCADDR-1Å)ÉDO¿DDUPÇIÅSWAPÇ<MATCH>´IF¿>RÅDDROPÇR>Ç-ÇIÇSWAPÇ-Ç0ÇSWAPÇ0Ç0ÇLEAVEå(ÅCADR,ÅBLEFT,Å$ADDR,Å$LENÉORÇ0,ÅOFFSET,Å0,Å0Ç)çTHEN∫LOOPºDDROPÑ(ÅCADDR-2,ÅBLEFT-1ÉORÇ0-2,ÅOFFSET-1Å)èSWAPÇ0=ÉSWAPÉ;Ï(ÇLINEØMVP-FORTH)ˇÅBASEÅ@ÇHEXı:ÅLINEÉ(ÅRELATIVEÅTOÅSCR,ÅLEAVEÅADDRESSÅOFÅLINEÅ)èDUPÇFFF0ÇAND≤ABORT"ÅNOTÅONÅCURRENTÅEDITINGÅSCREEN"õSCRÅ@Ç<LINE>ÇDROPÅ;ÈBASEÅ!˙:ÅWIPEÉSCRÇ@ÇCLEARÇ;ˇË(ÇEDITORÇ#LOCATE§MVP-FORTH)¿VOCABULARYÇEDITORÇIMMEDIATEÇBASEÅ@ÇHEX÷EDITORÅDEFINITIONSÓ:Å#LOCATEÑ(Å---ÅCURSORÅOFFSET-2,ÅLINE-1Å)ñR#Ç@ÅC/LÇ/MODÅ;ÌBASEÅ!ˇˇˇΩ(Ç#LEADÇ#LAGÇ-MOVEÇBUF-MOVEóMVP-FORTH)¿:Å#LEADÖ(Å---ÅCURSORÅADDR-2,ÅOFFSETÅTOÅCURSOR-1Å)ç#LOCATEÇLINEÇSWAPÇ;Ë:Å#LAGÖ(Å---ÅCURSORÅADDR-2,ÅCOUNTÅAFTERÅCURSOR-1Å)å#LEADÇDUPÇ>RÇ+ÇC/LÇR>Ç-Ç;ﬁ:Å-MOVEÖ(ÅMOVEÅFORMÅADDR-2,ÅTOÅLINE-1Å---Å)ìLINEÇC/LÇCMOVEÇUPDATEÅ;‰:ÅBUF-MOVEÑ(ÅMOVEÅTEXTÅTOÅBUFFER-1,ÅIFÅANYÇ---Å)éHEREÇC@∏IFÇPADÇSWAPÇC/LÇ1+ÇCMOVE£ELSEÅDROP∑THENÇ;∑(Ç>LINE#ÇFIND-BUFÉINSERT-BUFñMVP-FORTH)¿BASEÅ@ÇHEXı:Å>LINE#Ñ(ÅCONVERTÅCURRENTÅCURSORÅPOSITIONÅTOÅLINE#Å)ä#LOCATEÅSWAPÇDROPÇ;ˇ™:ÅFIND-BUFÖ(ÅBUFFERÅUSEDÅFORÅALLÅSEARCHESÅ)ìPADÇ50Ç+Ç;ˇ≤:ÅINSERT-BUFÖ(ÅBUFFERÅUSEDÅFORÅALLÅINSERTIONSÅ)èFIND-BUFÇ50Ç+Ç;ÏBASEÅ!∫(ÇHOLD-Ç<KILL>Ç<SPREAD>ÇXôMVP-FORTH)BASEÅ@ÇHEXµ:Å<HOLD>Ö(ÅMOVEÅLINE-1ÅFROMÅBLOCKÅTOÅINSERTÅBUFFERÅ)äLINEÅINSERT-BUFÇ1+ÇC/LÇDUPÇINSERT-BUFÇC!ÇCMOVEÇ;«:Å<KILL>Ö(ÅERASEÅLINE-1ÅWITHÅBLANKSÇ)òLINEÇC/LÇBLANKÉUPDATEÇ;‚:Å<SPREAD>É(ÅSPREAD,ÅMAKINGÅLINE#ÅBLANKÅ)ó>LINE#ÇDUPÉ0E∞DOÇIÅLINEÇIÅ1+Ç-MOVEÇ-1Ç+LOOPÇ<KILL>Ç;—:ÅXâ(ÅDELETEÅLINE#ÅFROMÅBLOCK,ÅPUTÅINÅINSERTÅBUFFER)Ü>LINE#ÇDUPÇ<HOLD>Ç0FÇDUPÇROTüDOÇIÇ1+ÅLINEÅIÇ-MOVEÇLOOPÇ<KILL>É;ïBASEÅ!∫(ÇDISPLAY-CURSORÇTÇLüMVP-FORTH)¿BASEÅ@ÅHEXˆ:ÅDISPLAY-CURSORÖ(Å---Å)¶CRÅSPACEÅ#LEADÅTYPEÅ5EÅEMIT•#LAGÅTYPEÅ#LOCATEÅ2Ç.RÅSPACEÇDROPÅ;Ÿ:ÅTí(ÅtypeÅline#-1Å)ùC/LÅ*ÅR#Å!ÅDISPLAY-CURSORÅ;„:ÅLë(ÅlistÅcurrentÅscreenÅ)òSCRÅ@ÇLISTÅDISPLAY-CURSORÅ;·BASEÅ!˙(ÇNÇBÇ(TOPÉSEEK-ERRORúMVP-FORTH)¿:ÅNÖ(ÅSELECTÅNEXTÅSEQUENTIALÅSCREENÅ)ô1ÇSCRÅ+!Ç;Ú:ÅBÖ(ÅSELECTÅPREVIOUSÅSEQUENTIALÅSCREENÅ)ï-1ÇSCRÇ+!Ç;:Å<TOP>Ñ(ÅRESETÅCURSORÅTOÅTOPÅOFÅBLOCKÅ)ó0ÅR#Ç!Å;ı:ÅSEEK-ERRORÖ(ÅOUTPUTÅERRORÅMSGÅIFÅNOÅMATCHÅ)ë<TOP>ÇFIND-BUFÇHEREÇC/LÇ1+ÇCMOVEõHEREÅCOUNTÇTYPE∞."ÅNONE"ÇQUITÇ;Ì(Ç<R>ÇP≠MVP-FORTH)¿BASEÅ@ÇHEXı:Å<R>Ö(ÅREPLACEÅCURRENTÅLINEÅWITHÅINSERTÅBUFFERÅ)ç>LINE#∫INSERT-BUFÇ1+ÇSWAPÇ-MOVEÇ;‡:ÅPá(ÅFOLLOWINGÅTEXTÅINÅINSERTÅBUFFERÅANDÅLINEÅ)å5EÇTEXT∏INSERT-BUFÉBUF-MOVE´<R>Ç;¯BASEÅ!ˇª(Ç1LINEÆMVP-FORTH)ˇ¡:Å1LINEÑ(ÅSCANÅCURRENTÅLINEÅFORÅMATCHÅWITHÅFINDÅBUFFERÅ)ê(ÅUPDATEÅCURSOR,ÇRETURNÅBOOLEANè)á#LAGÇFIND-BUFÇCOUNTÇMATCHÇR#Ç+!Ç;ˇˇˇˇ€(Ç<SEEK>É<DELETE>¢MVP-FORTH)BASEÅ@ÇHEXı:Å<SEEK>Ñ(ÅFINDÅBUFFERÅMATCHÅOVERÅFULLÅSCREEN,ÅELSEÅERRORÅ)ÑBEGINÇ3FFÇR#Ç@Ç<ÆIFÇSEEK-ERRORÇTHEN¨1LINEπUNTILÇ;ˆ:Å<DELETE>Ñ(ÅBACKWARDSÅATÅCURSORÅBYÅCOUNT-1Å)í>RÇ#LAGÇ+ÇR@Ç-Ñ(ÅSAVEÅBLANKÅFILLÅLOCATIONÅ)é#LAGÇR@ÇNEGATEÇR#Ç+!Ç(ÅBACKÅATÅCURSORÅ)î#LEADÇ+ÇSWAPÇCMOVE´R>ÇBLANKÇUPDATEÇ;É(ÅFILLÅFROMÅENDÅOFÅTEXTÇ)ÕBASEÅ!∫(Ç<F>ÇFÇ<E>ÉE§MVP-FORTH)BASEÅ@ÇHEXµ:Å<F>Ö(ÅFINDÅOCCURANCEÅOFÅFOLLOWINGÅTEXTÅ)î5EÇTEXT∏FIND-BUFÉBUF-MOVE≠<SEEK>É;Ù:ÅFá(ÅFINDÅANDÅDISPLAYÅFOLLOWINGÅTEXTÇ)î<F>ÇDISPLAY-CURSORÉ;Á:Å<E>Ñ(ÅERASEÅBACKWARDSÅFROMÅCURSORÇ)ôFIND-BUFÇC@Ç<DELETE>Ç;Â:ÅEÜ(ÅERASEÅANDÅDISPLAYÅLINEÇ)û<E>ÇDISPLAY-CURSORÇ;®BASEÅ!∫(ÇDÇTILL¨MVP-FORTH)¿BASEÅ@ÇHEXı:ÅDÜ(ÅFIND,ÅDELETE,ÅANDÅDISPLAYÅFOLLOWINGÅTEXTÅ)ç<F>ÇEÇ;ı:ÅTILLÉ(ÅDELETEÅFROMÅCURSORÅTOÅTEXTÅENDÇ)ñ#LEADÇ+Ç5EÇTEXTÆFIND-BUFÇBUF-MOVEÆ1LINEÇ0=ÇIFÇSEEK-ERRORÉTHEN†#LEADÇ+ÇSWAPÇ-Ç<DELETE>•DISPLAY-CURSORÇ;ÌBASEÅ!˙(ÇCOUNTERÉBUMP•MVP-FORTH)¿BASEÅ@ÇHEXıVARIABLEÇCOUNTERÇ0ÅCOUNTERÅ!‚:ÅBUMPÑ(ÅTHEÅLINEÅNUMBERÅANDÅHANDLEÅPAGINGÅ)ì1ÇCOUNTERÇ+!ÇCOUNTERÇ@¶38Ç>ÇIFÇ0ÇCOUNTERÇ!®CRÇCRÇ0CÇEMITÇTHENÇ;ÂBASEÅ!ˇˇº(ÇS≤MVP-FORTH)¿BASEÅ@ÇHEXı:ÅSÖ(ÅFROMÅCURRENTÅTOÅSCREEN-1ÅFORÅSTRINGÇ)í0CÇEMITÇ5EÇTEXTÇ0ÇCOUNTERÇ!üFIND-BUFÇBUF-MOVEÆSCRÇ@ÇDUPÇ>RÇDOÇIÇSCRÇ!¢<TOP>ªBEGINΩ1LINEÇIFÇDISPLAY-CURSORÇSCRÇ?ÇBUMPÇTHENì3FEÇR#Ç@Ç<Ç?TERMINALÅIFÅ1ÅELSEÅ0ÅTHENÅORëUNTILΩPAUSEÅ?TERMINALÅIFÅKEYÅDROPÅLEAVEÅTHENÉLOOPÇR>ÇSCRÇ!Å;¬BASEÅ!∫(ÇIÇUØMVP-FORTH)BASEÅ@ÇHEXµ:ÅIÖ(ÅINSERTÅTEXTÅWITHINÅLINEÖ)õ5EÇTEXTè(ÅLOADÅINSERTÅBUFFERÅWITHÅTEXTÅ)âINSERT-BUFÇBUF-MOVEá(ÅIFÅANYÇ)öINSERT-BUFÇCOUNTÇ#LAGÇROTÇOVERÇMINÇ>RïR@ÇR#Ç+!é(ÅBUMPÅCURSORÇ)òR@Ç-Ç>Rè(ÅCHARACTERSÅTOÅSAVEÅ)íDUPÇHEREÇR@ÇCMOVEÑ(ÅFROMÅOLDÅCURSORÅTOÅHEREÅ)çHEREÇ#LEADÇ+ÇR>ÇCMOVEÇ(ÅHEREÅTOÅCURSORÅLOCATIONÇ)âR>ÇCMOVEÇUPDATEÜ(ÅPADÅTOÅOLDÅCURSORÇ)ìDISPLAY-CURSORÇ;Ö(ÅLOOKÅATÅNEWÅLINEÇ)”:ÅUÑ(ÅINSERTÅFOLLOWINGÅTEXTÅUNDERÅCURRENTÅLINEÅ)èC/LÇR#Ç+!Ç<SPREAD>ÇPÇ;£BASEÅ!∫(ÇRÇMØMVP-FORTH)¿:ÅRÖ(ÅREPLACEÅFOUNDÅTEXTÅWITHÅINSERTÅBUFFERÇ)ê<E>ÇIÇ;ı:ÅMë(ÅMOVEÅFROMÅCURRENTÅLINEÅONÅCURRENTÅSCREENÅ)ÇSCRÇ@Ç>Rà(ÅTOÅSCREEN-2,ÅUNDERÅLINE-1Ç)êR#Ç@Ç>Râ(ÅSAVEÅORIGINALÅSCREENÅANDÅCURSORÅLOCATIONÅ)Ç>LINE#Ç<HOLD>Ñ(ÅMOVEÅCURRENTÅLINEÅTOÅINSERTÅBUFFERÇ)áSWAPÇSCRÇ!Ü(ÅSETÅNEWÅSCREENÅ#Ç)ô1+ÇC/LÇ*ÇR#Å!Ç(ÅTEXTÅISÅSTOREDÅUNDERÅREQUESTEDÅLINEÅ)á<SPREAD>É<R>Ñ(ÅSTOREÅINSERTÅBUFFERÅINÅNEWÅSCREENÇ)àR>ÇC/LÇ+ÇR#Å!Ç(ÅSETÅORIGINALÅCURSORÅTOÅNEXTÅLINEÉ)àR>ÇSCRÇ!Ç;Ö(ÅRESTOREÅORIGINALÅSCREENÇ)–FORTHÅDEFINITIONSÜ(ÅValueÅonÅstackÅ)ÇWARNINGÅ!å(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(ÇLOADÅSCREENÅFORÅUTILITYÅIDEOGRAMSíMVP-FORTH)111ÅDUPÅ.ÅLOADÅ112Å122ÅTHRU•125ÅLOADè\ÇSTARTINGÅFORTHÅADDITIONSé60ÅLOADê\ÇEDITOR†EXITˇˇˇˇˇˇÇ(ÇTHRUÇTITLEÇ'TITLEÇTRIADôMVP-FORTH)¿:ÅTHRUÉ1+ÅSWAP≥DOÇIÇU.ÇIÇLOADÇ?TERMINALÇIFÇLEAVEÇTHENÇLOOPÇ;∆:ÅTITLEÇCRÇ10ÅSPACES≠."ÅMOUNTAINÅVIEWÅPRESSÅFORTHÇVERSIONÅ1.0405.03"ÇCRÇ;∆VARIABLEÅ'TITLEÇ'ÅTITLEÅCFAÇ'TITLEÅ!⁄:ÅTRIADÉPAGEÇ0Ç3ÇU/MODÅSWAPÅDROPÉ3Ç*Ç3ÇOVERÇ+ÇSWAPÖDOÇCRÇIÇLISTÇ?TERMINAL©IFÅLEAVEÅTHEN∞1Ç/LOOPÉ'TITLEÅ@ÇEXECUTEÇ;ˇü(Ç\ÇBMOVEÇCOPYÇDOVERÇSWAPòMVP-FORTH)¿:Å\É>INÇ@ÇC/LÇ/Ç1+ÇC/LÇ*Ç>INÅ!Ç;òIMMEDIATEı:ÅBMOVEÉROTÇROTÇDDUPÇU<ßIFÇROTÇ<CMOVE±ELSEÇROTÇCMOVE∞THENÇ;ˆ:ÅCOPYÉOFFSETÇ@Ç+ÇSWAPÇBLOCKÇ2-Ç!ÇUPDATEÇ;Ã:ÅDOVERÉ4ÅPICKÇ4ÅPICKÇ;Â:ÅDSWAPÉ4ÅROLLÇ4ÅROLLÇ;Â(ÇDU<ÇD-ÇD0=ÇD=ÇD>ÇD@õMVP-FORTH)¡BASEÅ@ÇHEX¥:ÅDU<É>RÇ>RÇ8000Ç+¨R>ÇR>Ç8000Ç+ÇD<Ç;®BASEÅ!˘:ÅD-ÉDNEGATEÅD+Å;Ì:ÅD0=ÉORÇ0=Ç;Ô:ÅD=ÉD-ÅD0=Å;Ò:ÅD>ÉDSWAPÇD<Ç;Ì:ÅD@ÉDUPÇ2+Ç@ÇSWAPÇ@Ç;£(ÇDCONSTANTÇDMAXÇDMINûMVP-FORTH)¿:ÅDCONSTANTÉCREATEÉ,Ç,®DOES>ÇDUPÇ2+Ç@ÇSWAPÇ@Ç;‡:ÅDMAXÉDOVERÇDOVERÇD<™IFÅDSWAPÅTHENÉDDROPÅ;Ê:ÅDMINÉDOVERÇDOVERÇD<ÇNOT•IFÇDSWAPÇTHENÇDDROPÅ;ˇˇˇ®(Ç.INDEXÇPAUSE¶MVP-FORTH)¿:Å.INDEXªUSEÅ@ÅSWAP∂PADÅUSEÅ!ÇDUP≤SPBLKÇ*ÇT&SCALCØSEC-READ∏CRÅ4Å.RÇ2ÅSPACESØPADÅC/LÅ-TRAILINGÇTYPE©USEÅ!Ç;ı:ÅPAUSEÉ?TERMINAL∞IFÇ1000Ç0ÇDOÇLOOPÆBEGINÇ?TERMINALÉUNTIL®2000Ç0ÇDOÇLOOP¨THENÇ;∂(ÇDUMP-HEADER®MVP-FORTH)HEXΩ:ÅDUMP-HEADERÅCRÅCR∞OVERÇ0FÅAND¥."ÅADDRESSÑ"±DUPÅ8Å0ÅDOÅDUPÅ0FÅANDÅ3Å.RÅ1+ÅLOOPÅSPACEò8Å0ÅDOÅDUPÅ0FÅANDÅ3Å.RÅ1+ÅLOOPÅDROPÅ3ÅSPACESî10Å0ÅDOÅDUPÅ0FÅANDÅ0Å<#Å#Å#>ÅTYPEÅ1+ÅLOOPóDROPÅCRÅ;¥DECIMALπEXITˇˇ˛(ÇDUMPØMVP-FORTH)HEXΩ:ÅDUMPÉBASEÇ@Ç>RÇHEXÅDUMP-HEADERÅ0úDOÇCRÇDUPÇIÇ+ÇDUPÇ0Ç9ßD.RÇ2ÅSPACESÇDUPÇ8Ç0®DOÇDUPÇIÇ+ÇC@Ç3Ç.RÇLOOP¢DROPÇSPACEÇDUPÇ8Ç+Ç8Ç0§DOÇDUPÇIÇ+ÇC@Ç3Ç.RÇLOOP¢DROPÇ3ÅSPACESÇ10Ç0´DOÇDUPÇIÇ+ÇC@ÇDUPÇ20Ç<ÇOVERÅ7EÇ>ÇORñIFÇDROPÇ2EÇTHENÇEMIT•LOOPÇDROPÇ10≤PAUSEÇ?TERMINALÇIFÇLEAVEÇTHENú/LOOPÉDROPÇCRÇR>ÇBASEÇ!Ç;ùDECIMAL˘(ÇDUMPLÆMVP-FORTH)HEXΩ:ÅDUMPLÑBASEÇ@Ç>RÇHEXÅDUMP-HEADERÅ0öDOÅCRÅDDUPÇSWAPÅ0Å4ÅD.RÅ3AÅEMITÇ0Å4ûD.RÇ2ÅSPACESÉDDUPÉ8Ç0•DOÇDDUPÉIÇ+ÇC@LÇ3Ç.RÇLOOPüDDROPÇSPACEÇDDUPÉ8Ç+Ç8Ç0°DOÇDDUPÉIÇ+ÇC@LÇ3Ç.RÇLOOPüDDROPÇ3ÅSPACESÇ10Ç0™DOÇDDUPÉIÇ+ÇC@LÇDUPÇ20Ç<ÇOVERÅ7EÇ>ÇORìIFÇDROPÇ2EÇTHENÇEMIT•LOOPÅ10Å+Ñ10±PAUSEÇ?TERMINALÇIFÇLEAVEÇTHENú/LOOPÉDDROPÇCRÇR>ÇBASEÇ!Ç;úDECIMAL˘(ÇDVARIABLEÇID.ÇINDEXûMVP-FORTH)¿:ÅDVARIABLEÉCREATEÇ4ÇALLOTÇ;ﬂ:ÅID.ÇCOUNTÅ31ÅANDÅOVERÅ+ÅSWAP•DOÅIÅC@Å127ÅANDÅEMITÅLOOPÅ32ÅEMITÅ;Ÿ:ÅINDEXÉCRÅOVER≤BLOCKÅDROPÅ1+ÅBPDRVÅMINÅSWAPÅBPDRVÅMINöDOÇIÇ.INDEX≥PAUSEÅ?TERMINALÅIFÅLEAVEÅTHENÅ1Å/LOOPÅ;ˇˇÿ(ÇVLISTÆMVP-FORTH)HEXˇæ:ÅVLISTÉC/LÇOUTÇ!ÇCONTEXTÇ@Ç@üBEGINÇC/LÇOUTÇ@Ç-ÇOVERÇC@Ç1FÇANDÇ4Ç+Ç<íIFÇCRÇ0ÇOUTÇ!ÇTHEN©DUPÇID.ÇSPACEÇSPACEÇPFAÇ4Ç-Ç@ÇDUPóNOTÇPAUSEÇ?TERMINALÇOR§UNTILÅDROPµ;˝DECIMALÅEXITˇı(Ç.SSÇ.SLÇ.SRÇ.S¢MVP-FORTH)¿0ÅCONSTANTÅ.SSÜ\Å.SÅLEFTÅORÅRIGHTÅSWITCH”:Å.SLÅ0Å'Å.SSÅ!Å;É\Å.SÅWITHÅTOPÅOFÅSTACKÅONÅLEFTŒ:Å.SRÅ-1Å'Å.SSÅ!Å;Ç\Å.SÅWITHÅTOPÅOFÅSTACKÅONÅRIGHTÕ:Å.SÉCRÇDEPTH≥IFÇ.SSÅIFÇSP@ÉS0Å2-ÇELSEÇSP@ÇS0ÇSWAPÇTHENëDOÇIÅ@Ç0ÇD.Ç2Å.SSÅ+-Å+LOOPüELSEÅ."ÅEMPTYÅSTACK"¨THENÇCRÅ;ˇÙ(ÇSAVE-FORTH©MVP-FORTH):ÅSAVE-FORTHÖFREEZE¨13Ç0ÇSYSCALLÇDROPï\ÅRESETÅDISKÅSYSTEMÑ14Ç0ÇSYSCALLÇDROPõ\ÅSELECTÅDISKÑCRÅCRÅ."ÅFILEÅNAMEÅ?Å---"ÅPADÅ33Å0ÅFILLÅPADÅ1+Å11ÅBLANKâQUERYÇ46ÅWORDÅCOUNTÅ8ÅMINÅPADÅ1+ÅSWAPÅCMOVEõBLÅWORDÅCOUNTÅ3ÅMINÅPADÅ9Ç+ÅSWAPÅCMOVEíCRÅCRÅ."ÅPLACEÅYOURÅSYSTEMÅDISKÅINÅDRIVEÅAÅ"îCRÅ."ÅANDÅSTRIKEÅANYÅKEYÅ"ÅCRÅCRÜKEYÅDROPí19ÅPADÅSYSCALLÅDROPú\ÅDELETEÅFILEÑ22ÅPADÅSYSCALLÅDROPû\ÅMAKEÅFILEÑ256ÅBEGIN∫26ÅOVERÅSYSCALLÅDROPë\ÅSETÅDMAÅADDRESSä21ÅPADÅSYSCALLÅDROPí\ÅWRITEÅSEQUENTIALÜ128Å+ÅDUPÅHEREÅSWAPÅU<ÅUNTILÅDROPü16ÅPADÅSYSCALLÅDROPÇ;ö\ÅCLOSEÅFILEÅ(µMVP-FORTH)ˇˇˇˇˇˇˇ«(µMVP-FORTH)ˇˇˇˇˇˇˇ«(ÇLOADÅSCREENÅFORÅSUPPLEMEMTALÅIDEOGRAMSçMVP-FORTH)¿126Å128ÅTHRUˇˇˇˇˇˇ˙(Ç'SÇ-TEXTÇ2!Ç2@Ç2CONSTANTÇ2DROPÇ2DUPäMVP-FORTH)¿:Å'SÉSP@Å;Ù:Å-TEXTÉDDUPÅ+ÅSWAPÅDOÅDROPÅ1+ÅDUPÅ1-ÅC@ÅIÅC@Å-ÅDUPçIFÅDUPÉABSÅ/ÅLEAVEÅTHENÅ1Å/LOOPÅSWAPÅDROPÅ;—:Å2!ÉD!Ç;Ù:Å2@ÉD@Ç;Ù:Å2CONSTANTÉDCONSTANTÇ;Ê:Å2DROPÉDDROPÇ;Ó:Å2DUPÑDDUPÇ;Ø(Ç20VERÇ2SWAPÇ2VARIABLEÇ>BINARYÇ>ÅTYPEÇEMPTYÑMVP-FORTH)¿:Å2OVERÉDOVERÇ;Ó:Å2SWAPÉDSWAPÇ;Ó:Å2VARIABLEÉDVARIABLEÇ;Ê:Å>BINARYÇCONVERTÇ;Î:Å>TYPEÉ."ÇUSEDÅINÅMULTIPROGRAMMEDÅSYSTEMSÅONLY.Å"Å;âIMMEDIATE˜:ÅEMPTYºINIT-FORTHÇ@Ç'ÅFORTHÇ2+Ç!£INIT-USERÇUPÇ@Ç6Ç+Ç48ÇCMOVEÇ;ô(ÇERASEÇFLUSHÇHÇOCTALÇU.RÇ[']ìMVP-FORTH)¿:ÅERASEÉ0ÇFILLÅ;Ì:ÅFLUSHÇSAVE-BUFFERSÅ;È:ÅHÇDPÇ;ˆ:ÅOCTALÇ8ÇBASEÇ!Ç;Í:ÅU.RÉ0ÇSWAPÇD.RÅ;Í:Å[']É?COMPÉ[COMPILE]Ç'Ç;ÉIMMEDIATEˇ÷(µMVP-FORTH)ˇˇˇˇˇˇˇ«(ÅSCREENS>FILEÅ&ÅFILE>SCREENSÇLOADìMVP-FORTH)¿131Å138ÅTHRUÙCRÅCRÅ."ÅScreensÅloaded"ÉCRÅCRˇˇˇˇˇÂ(ÅCOMPRESS¨MVP-FORTH)CREATEÅCNTÅ0Å,Ú:ÅCOMPRESSÑ(Åaddr,Åblock#Å---ÅaddrÅ)ú0ÅCNTÅ!πBLOCKÇ1024ÅOVERÅ+ÅSWAP©DOÇIÅC@ÅDUPÅ32Å=±IFÇDROPÉCNTÅ@Å126Å=¨IFÅ255ÅOVERÅC!Ç1+É0ÅCNTÅ!§ELSEÅ1ÅCNTÅ+!≥THEN∫ELSEÇ>RÅCNTÅ@Å?DUP∞IFÅ128ÅORÅOVERÇC!Å1+Å0ÅCNTÅ!ÅTHENÅR>ÇOVERÅC!Å1+åTHEN∫LOOPÖCNTÅ@Å?DUP≠IFÉ128ÅORÇOVERÇC!Å1+ÅTHENÇ;ù(ÅEXPANDÆMVP-FORTH)¿:ÅEXPANDÜ(Åaddr,Åblock#Ç---Å)†0ÅCNTÅ!ÇDUPÅ>RÅBLOCKÅUPDATE§BEGINªOVERÅC@ÅDUPÅ128ÅAND∞IFÇ127ÅANDÇDUPÉCNTÅ+!©DDUPÉBLANKÑ+≠ELSEÅOVERÅC!Ç1+É1ÅCNTÅ+!•THENÇSWAPÅ1+ÅSWAPÆCNTÅ@Å1024Å=±UNTILÉDROPÇR>Å1+ÉFLUSHÇ;ˇˇ°(ÅCOMPRESSES,ÅEXPANDS°MVP-FORTH)¿:ÅCOMPRESSESÑ(Ålast-block+1,Åfirst-blockÅ---ÅaddrÇ)åPADÅROTÅROTµDOÅIÅ.ÅIÅCOMPRESSØLOOPÉ26ÅOVERÅC!Å;Í:ÅEXPANDSâ(Åfirst-blockÅ---Åaddr.Ånext-blockÅ)çPADÅSWAP∏BEGINÑDUPÅ.ÅEXPANDÆOVERÅC@Å26Å=±UNTILÅ;ˇˇ∏(ÅFCB,ÉMAKE-FCB•MVP-FORTH)¿CREATEÅfcbÅ44ÅALLOT≠:ÅFCBÇfcbÇ7Å+Å;Ô:ÅMAKE-FCBπ13Ç0ÇSYSCALLÇDROPö\ÅResetÅdiskÜCRÅCRÅ."ÅEnterÇ[d:]filename.typÅ---Å"öFCBÅ37Å0ÅFILLÅFCBÅ1+Å11ÅBLANK£QUERY©\ÅMakeÅFCBà46ÅWORDÇDUPÅ2+ÅC@Å58Å=´IFÅDUPÅ1+ÅC@Å65Å-Å14ÅSWAPÅSYSCALLÅDROPÜ\ÅSelectÅdriveàCOUNTÅ2-ÅSWAPÅ2+ÅSWAPÅELSEÅCOUNTÅTHENó8ÅMINÅFCBÅ1+ÅSWAPÅCMOVE©BLÅWORDÅCOUNTÅ3ÅMINÅFCBÅ9Å+ÅSWAPÅCMOVEÇCRÅ;—(ÅTO-PADÆMVP-FORTH)¿:ÅTO-PADªMAKE-FCB∏15ÅFCBÅSYSCALLú\ÅOpenÅfileã255ÅANDÉABORT"ÅFileÅnotÅfound.Å"ûFCBÅ16Å+Ç@Ñ128Å+ÉPADÅ+ÅPADä\ÅFindÅsizeãDOÇ26ÅIÇSYSCALLÅDROPî\ÅSetÅDMAê20ÅFCBÅSYSCALLÅDROPî\ÅReadÅsectorâ128Å/LOOP∑16ÅFCBÅSYSCALLÅDROPÅ;ï\ÅCloseÅfileˇˇ…(ÅSAVE-PAD¨MVP-FORTH)¿:ÅSAVE-PADÖ(ÅcountÅ---Å)ß16ÅFCBÅSYSCALLÅDROPÖMAKE-FCBä\ÅCloseÅfirstâ17ÅFCBÅSYSCALLÅ255ÅANDÅ0=î\Å?ÅExistäIFÅCRÅ."ÅFileÅexists.ÅReplace?Ç<Y>Å:Å"ÅKEYÅ89Å-íIFÅ."ÅAbortedÅ"ÅABORTÅELSEÅ19ÅFCBÅSYSCALLÅDROPÅTHENÅTHENÜ22ÅFCBÅSYSCALLÅDROPó\ÅMakeÅfileã128Å+ÇPADÅ+ÉPADÆDOÅ26ÅIÅSYSCALLÅDROPñ\ÅSetÅDMAê21ÅFCBÅSYSCALLÅDROPî\ÅWriteÅsequentialÑ128Å/LOOP∑16ÅFCBÅSYSCALLÅDROPÇ;î\ÅCloseÅfileˇ»(ÅSCREENS>FILE®MVP-FORTH)¿:ÅSCREENS>FILEµCRÅCRÅ."ÅWillÅconvertÅasÅrangeÅofÅscreensÅtoÅaÅ"êCRÅ."ÅcompressedÅfileÅwithÅprompts."ÇCRÅCRï."ÅEnterÅtheÅbeginningÅscreenÅnumberÅ-->Å"ñQUERYÅBLÅWORDÅNUMBERÅDROPßCRÅ."ÅEnterÅtheÅlastÅscreenÅnumberÜ-->Å"ìQUERYÅBLÅWORDÅNUMBERÅDROPÉ1+ÅSWAPùCRÅCRÉCOMPRESSESÑPADÅ-ÑSAVE-PADôCRÅCRÅ."ÅFileÅsaved.Å"ÅCRÅCRÅ;                                                                                                                                                                                                                                                                                                                                                               (ÅFILE>SCREENS®MVP-FORTH)¿:ÅFILE>SCREENSµCRÅCRÅ."ÅWillÅconvertÅaÅcompressedÅfileÅtoÅtheÅnecessary"äCRÅ."ÅnumberÅofÅblocksÅwithÅprompts."òTO-PAD∫CRÅCRÅ."ÅEnterÅtheÅbeginningÅscreenÅnumberÅ-->Å"êQUERYÅBLÅWORDÅNUMBERÅDROPßCRÉCRÉEXPANDSÇDDROP®CRÅCRÅ."ÅScreensÅloaded.Å"ÉCRÅCRÉ;◊:Å<IBM-PAGE>∑3Å0Å0Å0Å16ÅINTCALLÅDROPÅ;‰'Å<IBM-PAGE>ÅCFAÅ'PAGEÅ!™(ÅMakeÅgenericÅpageÅworkÅonÅIBM.Å)ú(µMVP-FORTH)ˇˇˇˇˇˇˇ«ˇˇˇˇˇˇˇˇà                                                                                                                                