exrel-mod
(RPRED external listex listfile LISTEX LISTFILE open close internal)
("?REV-P?" opened)
((COPYRIGHT 1983 LPA LTD V3-2))
((Exx X Y Z x)
  (DELCL ((Y|y)|z))
  (WRITE X ( ((Y|y)|z) ))
  (SEEK X X1)
  (Exx X Y X1 x))
((Exx X Y Z Z))
((Ext X () Y)
  /)
((Ext X (Y|Z) x)
  (Exx X Y x y)
  (ADDCL ((Y|z)(RPRED X x y (Y|z))))
  (Ext X Z y))
((external Y)
  (CREATE Y)
  (R Z)
  (IF (CON Z) ((Ext Y (Z) (0|0)))
	     ((Ext Y Z (0|0))))
  (CLOSE Y))
((test X Y)(CL ((opened Y)))/)
((test X Y)(X Y))
((listfile Y)
  (OPEN Y)
  (int Y (0|0) y print)
  (test CLOSE Y))
((LISTFILE Y)
  (OPEN Y)
  (int Y (0|0) y PP)
  (test CLOSE Y))
((listex X) 
  (CL ((X|z)(RPRED Y x y (X|z))))(OPEN Y)
  (int Y x y print)(test CLOSE Y))
((LISTEX X)
  (CL ((X|z)(RPRED Y x y (X|z))))(OPEN Y)
  (int Y x y PP)(test CLOSE Y))
((print X)
  ("?REV-P?" X X1)
  (P|X1)(PP))
((open X)(IF (CL ((opened X))) () ((OPEN X)(ADDCL ((opened X))))))
((close X)(CLOSE X)(IF (DELCL ((opened X))) ()()))
((internal X)
  (CL ((X|z)(RPRED Y x y (X|z))))(OPEN Y)
  (int Y x y ADDCL)(test CLOSE Y)
  (DELCL ((X|X1) (RPRED|X2))))
((int Y x y z)
  (less x y)
  (SEEK Y x)
  (READ Y X)
  (z X)
  (SEEK Y x1)/
  (int Y x1 y z)) 
((int Y x y z))
((less x y) (VAR y)/)
((less (x|y) (x|y1))
   /(SUM y 2 y2)(LESS y2 y1))
((less (x|y) (x1|y1))
   (LESS x x1))
((RPRED X Y Z x)
  (SEEK X Y)
  (READ X y)
  (SEEK X z)
  (OR ((EQ (x|x1) y) (? x1)) ((less z Z) (RPRED X z Z x))))
CLMOD
(RPRED X Y Z x)
  (SEEK X Y)
  (R