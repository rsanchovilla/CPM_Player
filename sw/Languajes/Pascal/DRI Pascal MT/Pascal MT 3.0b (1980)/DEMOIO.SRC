{$q-} {supress verbose compiler output}

PROGRAM DEMOIO;

CONST
  BUFSIZE = 127;
  RECSIZE = 79;

TYPE
  BUFFER = PACKED ARRAY [0..BUFSIZE] OF CHAR;
  REC    = PACKED ARRAY [0..RECSIZE] OF CHAR;

VAR
  TITLE : PACKED ARRAY [0..11] OF CHAR;
  INFILE : TEXT;
  INBUF : BUFFER;
  EOF : BOOLEAN;
  INDEX : INTEGER;
  RESULT : INTEGER;


  CHARACTER:CHAR;

(*$I FILEIO*)


(* SAMPLE INPUT ROUTINE WHICH USES GNB TO INPUT FROM DISK TEXT FILE *)

FUNCTION NEXTCH:CHAR;
VAR CH : CHAR;
BEGIN
  CH := GNB(INFILE,INBUF,INDEX,EOF);
  NEXTCH := CH
END;

(* SAMPLE OUTPUT ROUTINE WHICH OUTPUTS TO CONSOLE ON MT MICROSYSTEMS CPU *)

PROCEDURE PUTCH(CH:CHAR);
BEGIN
  WHILE INPUT[5] & $01 =0 DO;
  OUTPUT[4] := CH
END;


BEGIN
  TITLE := ' DATA1   SRC';
  TITLE[0] := CHR(0);
  OPEN(INFILE,TITLE,RESULT);
  WRITELN('RESULT FROM OPEN = ',RESULT);
  INDEX := BUFSIZE+1;
  EOF := FALSE;


  WHILE NOT EOF DO
    BEGIN
      READ([ADDR(NEXTCH)],CHARACTER);
      IF CHARACTER <> CHR($0A) THEN
        WRITE([ADDR(PUTCH)],CHARACTER)
    END;

END.

