100 COMMON D$,F$
110 DIM PR$(1000)
120 WIDTH 128
130 IF D$="" THEN 150 ELSE 140
140 IF MID$(D$,5,1)="A" THEN 340 ELSE 540
150 PRINT CHR$(26):PRINT"***************************************************"
160 PRINT"*       Old Graphics/New GFX File Convertor       *"
170 PRINT"***************************************************"
180 PRINT:INPUT"NEW/OLD (N/O) ";NO$
190 IF NO$="N" OR NO$="O" THEN 200 ELSE 180
200 PRINT:INPUT"DRIVE TO READ FILES FROM ";P$
210 IF P$="A" OR P$="B" THEN 220 ELSE 200
220 PRINT:INPUT"DRIVE TO WRITE CONVERTED FILES ";Q$
230 IF Q$="A" OR Q$="B" THEN 240 ELSE 220
240 P$=P$+":":Q$=Q$+":"
250 PRINT"ENTER <CR> TO END CONVERSION PROGRAM" 
260 PRINT:INPUT"FILENAME TO CONVERT <CR>";F$
270 PRINT CHR$(26):FOR B=1 TO 22:PRINT:NEXT B:POKE 61440!+(23*128),32
280 IF F$="" THEN 540
290 IF NO$="N" THEN 300 ELSE 550
300 G$=P$+F$+".BAS"
310 D$=Q$+P$+"A"
320 ON ERROR GOTO 530
330 CHAIN G$
340 REM*****************WRITE PROGAM SECTION********
350 Q$=MID$(D$,1,2):P$=MID$(D$,3,2)
360 RESTORE 510:F$=Q$+F$+".GFX"
370 FOR B=0 TO 60:O%=PEEK(62720!+B):POKE 64768!+B,O%:NEXT B
380 FOR B=0 TO 60:READ M:POKE 62720!+B,M:NEXT B:FOR B=1 TO TIMELIM*2:NEXT B
390 FOR B=0 TO 60:O%=PEEK(64768!+B):POKE 62720!+B,O%:NEXT B
400 REM **********SAVE PROGRAM TO DISK***********
410 OPEN "O",#1,F$
420 T=0:Z=0:N1=0:N3=0
430 FOR N1=0 TO 3072
440 Z=N1+61440!:T=PEEK(Z)
450 IF T<>32 THEN 460 ELSE 470 
460 PRINT#1,T;N3;:POKE Z,127:N3=1:GOTO 480
470 N3=N3+1
480 NEXT N1
490 PRINT #1,32;32
500 CLOSE:C$="":PRINT CHR$(26):GOTO 250
510 DATA 32,32,32,32,32,32,32,32,32,32,32,83,65,86,73,78,71,32,70,73,76,69,32,95,32,80,76,69,65,83,69,32,87,65,73,84
520 DATA 32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32
530 PRINT"SORRY, UNABLE TO OPEN FILE FOR CONVERSION."
540 END
550 ON ERROR GOTO 530
560 S1=61440!
570 GOSUB 600
580 GOSUB 620
590 GOTO 680
600 REM * 2-clear screen routine **********************************************
610 PRINT CHR$(26)CHR$(11)CHR$(11):POKE 64384!,32:RETURN
620 REM * 4-fill screen routine ***********************************************
630 S2=0:T=0:ON ERROR GOTO 530
640 OPEN "I",#1,P$+F$+".GFX"
650 WHILE T<>32:INPUT #1,T,S2:IF S1+S2>=64512! THEN 670 ELSE 660
660 POKE S1+S2,T:S1=S1+S2:WEND
670 CLOSE:RETURN
680 REM*****************WRITE PROGAM SECTION********
690 CU=1:LN=100:IC=10
700 FOR B=0 TO 60:O%=PEEK(62720!+B):POKE &H9200+B,O%:NEXT B
710 FOR B=0 TO 60:READ M:POKE 62720!+B,M:NEXT B
720 FOR B=0 TO 60:O%=PEEK(&H9200+B):POKE 62720!+B,O%:NEXT B
730 DATA 32,32,32,32,32,32,32,83,65,86,73,78,71,32,70,73,76,69,32,95,32,80,76,69,65,83,69,32,87,65,73,84
740 DATA 32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32
750 PR$(CU)=STR$(LN)+" PRINT CHR$(26)":CU=CU+1:LN=LN+IC
760 PR$(CU)=STR$(LN)+" WHILE A<>32:Z1=Z:READ Z,A:Z=Z1+Z:POKE Z+61440!,A:WEND
770 CU=CU+1:LN=LN+IC
780 N2=0
790 FOR N=0 TO 2944 STEP 128
800 FOR N1=N TO N+127
810 Z=N1+61440!
820 T%=PEEK(Z)
830 IF T%=32 THEN 910
840 POKE N1+61440!,127
850 Z%=N1-N2
860 Z$=MID$(STR$(Z%),2):T$=MID$(STR$(T%),2)
870 IF LEN(PR$)<50 THEN PR$=PR$+Z$+","+T$+",":GOTO 900
880 PR$(CU)=STR$(LN)+" DATA "+PR$+Z$+","+T$
890 CU=CU+1:LN=LN+IC:PR$=""
900 N2=N1
910 NEXT N1
920 NEXT N
930 PR$(CU)=STR$(LN)+" DATA "+PR$+"32,32"
940 CU=CU+1:LN=LN+IC
950 PR$(CU)=STR$(LN)+" END"
960 REM **********SAVE PROGRAM TO DISK***********
970 OPEN "O",#1,Q$+F$+".BAS"
980 FOR N=1 TO CU+1:PRINT#1,PR$(N):NEXT N
990 CLOSE #1:GOSUB 600
1000 GOTO 250
SK***********
970 OPEN "O",#1,Q$+F$+".BAS"
9