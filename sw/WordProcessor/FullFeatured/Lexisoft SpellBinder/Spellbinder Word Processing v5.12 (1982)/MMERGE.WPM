###      1-15-82              ***     маил мерге          ***                   This Macrofeature allows you to fill in a letter with   information from successive customer files.                       The 'demo' option prints on the screen and stops after each letter is processed.  When it stops, you can continue by hitting the space bar.  The disk files called 'LETTER.DEM' and'CUSLIST.DEM' are formatted correctly for use with this macro,and can be used for demonstration purposes.     The production option goes to the printer and stops after each letter only if you specify a single sheet printer.  If you are using a tractor feed, it keeps on trucking.##A    "10"   "How many lines per customer record?               "B    "0 "   "Set 0 for single sheet, 2 for tractor paper       "C    "1 "   "Set 1 for Demo, 0 for Production Run              "D    "1 "   "Set 1 with cue or separator line, 0 without       "#:on -1 115     SET UP OPTIONS;;;;;;;:PR "#1/":in "#0/#13/#13/#6/Filename of your letter:  " %Cro/%C/:ON $0 / /-3 /R/e/s//.s</t/h:in "#0/#13/#13/#13/#6/Filename of customer file:    " %Dro/%D/:ON $0 / /-3 /;;;R%1:CP:on ?-3 / 105 / ;EOF:on %4 / 34 /:ON ?-46 / 33 /:ON ?-65 / 33 /:PR "#0/#6/Error in customer file ...":in " Hit RET to continue, ESC to exit  "D1t/us/.s/?/         ;delimit every field with quotesf1%1s//"/s/</"</;;FILL IN LETTER:%5 = %5+1T/s/.s/?/f1:on ?-3 /  105  ;EXIT on end of file:%D = !      ;pick up variables one at timeb0/d1/t/s/@%5/?/:on ?-3 / 75 /:%9 = $3s/`/:%8 = $3:%C = "":%6 = 0:SL %D %7:on %8-%9 60 / 60       ;on this line?:on %7-2 / 57 57:sf %D 2:%7 = 2:%C = "??????????????????????????????????????????????????????????????":sf %C %7-2:%6 = 1t:%9 = %9-1:on %9 64 64 /f%9:on %7 / 69 /s/@%5/%D/:on %6 68 68 /s/%C`/`/:on -1 45s/@%5//b0:on ?-13 73 / 73d1              ;remove line if otherwise blank:on -1 45;:ON %5-%1 40 / /:%5 = 0t/s100/`/ /:on %3 / 90 /;;       Screen PRINT DEMO;Y 1 90 110 2 0 1 0 65 2 1 1 0 35 5t/vt/d1000:on -1  25;;;;;       ACTUAL RUN PRINTt/s/.s/.e/t/F8:cpT:on %2-0 / / 96:in "#0/#6/Insert paper in printer.  Hit a return to continue":pr "#0/#6/PRINTING ..."P:ON ?-3 94 / 94t/d1000:PR "#0/#6/":on -1 25:pr "#1/#13/#13/        JOB COMPLETED#13/#13/":in "      Hit any key to regain control"t/h0/h/h0:pr "#1/":on -1 150;;;;;h0              ;initialization:%1 = $0:on %1 / 120 /rd;OPTION TABLEY 1 90 110 2 0 1 0 65 2 1 1 0 35 5YT 0 0 0 0 0 0 0:%1 = $A       ;how many lines in each file:%2 = $B       ;set to 1 for continuous paper:%3 = $C       ;SET 1 FOR DEMO:%4 = $D       ;validity check:on -1 2