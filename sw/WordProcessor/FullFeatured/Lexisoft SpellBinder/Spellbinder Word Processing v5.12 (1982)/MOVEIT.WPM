;          Moveit.11           7/1/82:SS 50 45 5 5 5 80 159 5:PR "#1/#13/#13/#13/Do you wish to:#13/":PR "   1   Delete   Columns#13/":PR "   2   Exchange Columns#13/":PR "   3   Retain   Columns#13/":PR "   4   Insert   Columns from Disk#13/":PR "   5   Expand   Columns#13/":PR "   6   Exit#13/#13/":PR "WHICH ?  ":%D = "Y":RK %1:%A="#0/#3/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/":%B="#3/#6/************************************":ON %1-52 / 142 /   ;4:ON %1-53 / 191 /   ;5:ON %1-54 / 266 /     ;6:ON %1-51 / 22 / ;3:ON %1-50 / 22 / ;2:ON %1-49 / 22 / ;1:ON -1 3;:CP      ;Refresh display;:PR "%A#6/Γυςσος το Ζιςστ Γομυνξ αξδ στςιλε γοξτιξυε":PR "%A%B":CM      ;Return cursor to text position:EE 29 ;Allow edit:CM:%2 = $2   ;Record first column:PR "%A#6/Γυςσος το Ζιξαμ Γομυνξ αξδ στςιλε γοξτιξυε":CM:EE 34:CM:%3 = $2   ;Record last column;:PR "%AΖος αμμ ςοχσ ιξ δογυνεξτ ¨Ω―Ξ©Ώ#6/  ":IN %C:ON %D%C / 48 /    ;If not all rows;THEN WHICH ONES?:PR "%AΓυςσος οξ ζιςστ ςοχ αξδ στςιλε γοξτιξυε#6/":EE 43:%5 = $3 - 1 ;Record first row (-1):PR "%AΓυςσος οξ μαστ ςοχ αξδ στςιλε γοξτιξυε#6/":EE 46:%6 = $3     ;Record last row:ON -1 53;ELSE FIRST THRU LAST ROWS:%5 = 0      ;First row (-1)E:%6 = $3 -1  ;Last rowT;:%9 = 56       ;Square off rows from %5+1 to %6 over to column %3:ON -1 244t/f%5:ON %1-51 / 119 /   ;3  These all share %2, %3, %5, %6, and 244:ON %1-50 / 85 / ;2    call.:ON %1-49 / 62 /   ;1;;******  MAJOR ROUTINES  ******;DELETE COLUMNSt/f%5           ;Position to first row:CM           ;Loop;:MC %3+1         ;Delete specified columnss//^/:MC %2d:cmb0              ;Keep display pretty;;;f1;:ON $3-%6 / / 266    ;IF beyond last row or to end of text,:ON ?-3 / 266 /      ;   THEN Exit-loop by returning to menu;:ON -1 65     ;END-LOOP;;;EXCHANGE COLUMNS:PR "%AΓυςσος το Ιξσταμμ Γομυνξ τθεξ Γοξτιξυε":PR "%A%B":EE 88:%4 = $2             ;Record install column:%7 = %4             ;Permanently!:ON %4-%2 92 92 /    ;Not allowed to put a column in the middle of itself:ON %4-%3 266 266 /t/f%5               ;To first row of column to be moved:cp              ;Exchange loop:MC %3+1             ;Pick up column text (in current row)s//^/:MC %2h0/h/s/?//          ; and erase mark;:%4 = %7:ON %4-%2 103 103 /:%4 = %7 - %3 + %2-1 ;If move is to the right, then adjust for that fact:MC %4               ;Put it down in the correct spotU:cmB0                  ;Keep display pretty;;;f1                  ;Advance a row;:ON $3-%6 / / 114  ;If beyond last row or to end of text, then exit loop:ON ?-3 94 / 94t/f%5/h0            ;Back to first row of column of data to be moved & clr:ON -1 266         ; hold;;;RETAIN COLUMNSe:%0 = $3               ;Record # of rows in text (row # of last one)t/f%5              ;set starting row:MC %3+1             ;Pickup portion of row to saves//^/:MC %2:%F = !^;:%4 = $3             ;Record current row #;e                   ;Drop at end of text terminated by <CR>s//%F</:PR "%F#6/#13/";t/f%4:ON $3-%6 / / 136  ;If beyond last row or to original text, then exit loop:ON %4-%0 122 // t/d%0-1       ;Delete original text:ON -1 266;;;;INSERT COLUMNS FROM DISK:PR "%A%B":PR "%A#6/Ταςηετ ζιμε οξ δισλ ¨°© ος νενοςω ¨±©  ::IN %9:PR  "%A#6/Χθατ ισ ιξσεςτ δατα ζιμεξανε  :  ":IN %G:ON %9-0 / / 152:PR "%A#6/Χθατ ισ ταςηετ ζιμεξανε  :  ":IN %F           ro/%F/          ;Open and read target filer:%5 = $3-1         ;Start row minus 1 of target file;ro/%G/            ;Read insert datar:%4 = $3-1         ;Start row minus 1 of insert data;t:CP:PR "%A%B":PR "%AΓυςσος το οχ ¦ Γομυνξ αξδ στςιλε γοξτιξυε#6/":EE 163:PR "#7/":%7 = $3-1           ;Row minus 1 to insert data:%3 = $2             ;Column to insert data;:%6 = %5+$3-%4-1     ;Last of rows minus 1 to receive data:%9 = 170           ;Square off to insert column:ON -1 244;t/f%4                   ;Read insert data row:%F = !<;b0/d1                   ;Delete row;t/f%7                   ;Position then insert data:MC %3s//%F/;:%7=%7+1                  ;Advance to next row;b0                      ;Keep display pretty:%F=!<:PR "#13/#2/%F";:ON %4-%7 / 266 /    ;Exit when insert target is in data area:ON -1 171;;;EXPAND COLUMNS:CP:PR "%A#6/Γυςσος το σταςτ αξδ στςιλε γοξτιξυε":PR "%A%B":CM:EE 196:CM:%3 = $2:PR "%AΖος αμμ ςοχσ ιξ δογυνεξτ ¨Ω―Ξ©Ώ#6/  ":IN %C:ON %D%C / 210 /;THEN:PR "%AΓυςσος οξ ζιςστ ςοχ αξδ στςιλε γοξτιξυε#6/":EE 204:%5 = $3-1       ;Record first row - 1:PR "%AΓυςσος οξ μαστ ςοχ αξδ στςιλε γοξτιξυε#6/":EE 207:%6 = $3         ;Record last row:ON -1 214;;ELSE:%5 = 0          ;First row -1E:%6 = $3 - 1     ;Last row;:%9 = 217       ;Square off to expand point:ON -1 244;:PR "%AΕψπαξδ χιτθ χθατ γθαςαγτες¨σ©#6/":IN %F:%2=%5               ;Initialize row index;;;t/f%2                   ;Position to current row to expand;:ON ?-3 / 239 /  ;If to end of text, exit loop;:MC %3                   ;Insert expansion strings//%F/;:CM                      ;Keep display prettyb0:%G = !<;:PR "#13/#2/%G";:%2=%2+1                  ;Advance a row;:ON $3-%6 223 223 / ;Check for row limits;t/f%5               ;Restore to first expanded row:ON -1 266;;; Fills out rows thru column %3 and lines from %5+1 to %6;  Returns cursor to top of text.  Returns thru %9.;; CALLING FORMAT: %9=return address;                 GOTO 244;:%G=""               ;Initialize blank stringT/F%5               ;Position to first row to square off                   ;WHILE not to end of text or rows to squareSL/<            ;Find end of row:ON ?-3 / 262 /      ;:ON $3-%6 / / 262  ;:%8 = %3-$2+1    ;Calculate size of fillin:ON %8-0 252 252 / ;If row already just right or longer, then NEXT-LOOP:SF %G %8        ;Set blank string to correct lengthS//%G/          ;Insert blanks at end of row:cm:ON -1 252T/F%5               ;Position to first row of squared area:cp:ON -1 %9             ;Return to caller;:CP:EE 268:ON -1 2