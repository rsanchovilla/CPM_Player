;       calculator macro, version 3.3;;;;       initialize;:FL 14 2     ;Set precision:SS 20 20 20 70 20:%D= "Áddd Óuub Âuus Íuul Òeev Úero Ðuut Ånnter Ãolns";:%F = ".00":%G = ".00":%J = "                    ":%5 = 0:on -1 35;;;;;;;;;;;;;;:pr "#0/*error* %D#6/" ;error return:on -1 40;:%1 = $2         ;Save column:%6 = $3 - 1     ;Save row - 1:PR "#0/        %D#6/":oe  30:%K = "%b":%L = %J:sl %K %7:sf %L 20-%7:%K = "%L%K":PR "#13/E[%K]  X<%F> Y<%G>#6/":CM:%7=%5:%5 = 0                 ;set return flag:on %7 / /+1 /:ee 35:%d = %b                ;get first operand:RK %4:on %4-96 /+1 /+1 /     ;cap lock:%4 = %4-32:%2 = %4                ;save command:%4 = 0                 ;pass key:on %2-45 67 / /:on %2-58 / 67 67:%4 = %2:%2 = 69                ;fake an "e";Go to appropriate operation routine;:ON %2-80 / 243 / ;Put:ON %2-82 / 234 / ;Reverse:ON %2-90 / 238 / ;Zero:ON %2-67 / 295 / ;Column Add:on %2-69 /  90 / ;Enter:ON %2-65 /  90 / ;Add:ON %2-83 /  90 / ;Sub:ON %2-66 /  90 / ;Bus:ON %2-77 /  90 / ;Mult:ee 35         ;exit   ;Get input for second operand into %a:on %4 /+3 / /+3:pr "#0/Enter T,X,Y or number#6/#13/E[%J]#4/":cm:rk %4:on %4-16 / 35 /        ;ESC:on %4-96 /+1 / /:%4 = %4-32:on %4-84 / 124 /       ;"t":on %4-88 / 122 /       ;"x":ON %4-89 / 120 /       ;"Y":on %4-43  94           ;> or = "-":on %4-58 / 94  94      ;and < or = "9";       Get numeric input:%K = "%J":%L = "":sp %L %4:sg %K %4:%K = "%K%L":pr "#0/#13/E[%K]#4/":rk %4:on %4-13 / /+5 /       ;done:on %4-90 / 92          ;clear entry:on %4-122 / 92:on %4-16 / 35 /:on %4-43 /-5 / /:on %4-58 /-11 /-7 /-7:%a = %K:on -1 130:%a = %G:on -1 130:%a = %F                ;Input from memory:ON -1 130:%a = !                 ;Input from Textt/f%6:MC %1:%5 = 1:on %2-69 / 230 / ;'e':ON %2-65 / 168 / ;'A':ON %2-83 / 174 / ;'S':ON %2-66 / 181 / ;'B':ON %2-77 / 186 / ;'M';;;:ON -1 35  ;store data into accumulator;;:%L = "%d":sg %L %7       ;check sign:on %7-45 / /+1 /:sp %L %7:sl %L %7:on %7-18 / 30 30       ;limit digits:%b = %d;:ON -1 35;******* BINARY OPERATION ROUTINES *******   ;'A' or 'a'     Add input to destination:FA %d %a            ; I + D:ON -1 142   ;'S' or 's'     Subtract input from destination:%a = -%a            ; D - I:FA %d %a:ON -1 142   ;'B' or 'b'     Subtract destination from input:%d = -%d            ; I - D:FA %d %a:ON -1 142   ;'M' or 'm'     Multiply %a by %b, result in %d:%c = 0     ;Accumulator:%K = "%a"  ;multiplier in %K:%a = %b:%M = "":sg %K %7       ;put multiplier backward in %M:on %7-45 /+2 / /+2:%a = -%a:SG %K %7:on %7-13 / 200 /:on %7-48 /-3 / /:sp %M %7:on -1  /-5;:sg %M %7       ;get next digit:on %7-13 / 215:%7 = %7-48:on %7 / /+3 / :fa %c %a       ;add %7 x %a to %c:%7=%7-1:on -1 /-4:fl 15 1     ;X 10:%L = "%a":fl 14 2:%a = %L:on -1 200;:%d = .5        ;done:%L = "%c":sg %L %7:on %7-45 /+1 / /+1:%d = -.5:fa %d %c       ;round up:fl 12 4:%L = "%d":fl 14 2:%d = %L:on -1 142;*****UNARY Routines   ;'E' OR 'e':%d = %a:on -1 142   ;'R' or 'r'         Reverse sign of destination:%d = -%d:ON -1 142   ;'Z' or 'z'         Zero SUM:%b = 0                  ;Sum <-- 0:ON -1 35;Put SUM into text or memory:pr "#0/#6/X,Y,or T: ":rk %7:on %7-96 /+1 / /:%7 = %7-32:on %7-84 / 263 /:on %7-88 / 253 /:on %7-89 / 256 /:on -1 142:%F = "%b":on -1 142:%G = "%b":on -1 142;Insert %d into text:%L = "%d":SL %L %7:%8 =  $2-%7+3  ;save the column number for transfer to text:ON %8-0 / 269 269:%8 = 0;sl/&&&/?:ON ?-3 273 / 273S//</B1;:%9 = %7+%8-$2  ;no of chars to add:ON %9-0 281 281 /:%M = "%J":SF %M %9S/?/%M</B1:%L = "%L<";:%M = "????????????????????":SF %M %7:MC %8:CM:PR "%L"s/%M/%d/:%5 = 1:ON -1 142   ;'C' or 'c'             Add a column of numbers;;:%d = 0      ;Zero column accumulator:pr "#0/#6/How many rows to add? ":in %3;;:ON %3 / 328 /      ;Done with adding?:ON $3-1 / 328 /    ;HIT TOP?B1:MC %1:on ?-43 /-4 / /:on ?-58 / /-5 /-5  ;par of a number?:on $2 / 320 /  :mc $2-1:on ?-32 /-3 / /-3  ;wait for a space:mc $2+1:%a = !:FA %d %a:%3= %3-1:ON -1 305;t/f%6       ;Position past last entry:MC %1:%b = %d:ON -1 35;;;       ARITHMETIC MACRO MATH.33 July 14, 1982;