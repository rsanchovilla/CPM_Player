;5/22/82                ADDIT.9:SS:%6=$3-1:%9 = $2:%4 = %9:%C = ".00";;;PRIOR TEXT PROCESSING;line screen to sufficient widthsl/<:ON ?-13 / 28 /:%7 = $2:ON %5-14 /+1 / /+1:%7-%7+1f1sl/<:%2 = $2:%1 = %7+%2+20:%2 = %7 + %2:ON %1-159 / 143 143:ON %1-20 148 148 /L%1:CP:ON -1 37;;sl/<:%1=$2+16:%2=$2:ON %1-79 /+5 // :ON %1-159 / 143 143L%1;;;:PR "#0/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/#5/":PR "#6/#5/#5/#5/#5/'r' for row, 'c' for column, 'e' for exit":RK %1:ON %1-69 / 131 /:ON %1-101 / 131 /:PR "#0/#6/";;;;FIND LAST ROW OF NUMBERSf1:ON ?-3 /+1 / /+1:ON %1-114 139 /+1 139:ON ?-13 /-4 / /-4:%8 = $3:ON %1-82 / 108 /:ON %1-114 / 108 /B0:CPs//    /;                ;Space fill totals line:ON $2-%2 /-2 // F1/S//</t/f%6;;;GET COLUMN INFORMATION:MC %4                   ;Code beginning of column:ON ?-13 / 131 /sl/.:ON ?-13 / 131 /:%2=$2+3                 ;Code location of end of column;;;;PROCESS VERTICAL NUMBERS:MC %4sl/£:ON ?-13 / /+5 /         ;If yes repeat; if no do routine below:ON $2-%2 / / /+4        ;Check for empty cells:MC $2-1:ON ?-32 /-2 / /-2:%b = !:FA %a%bf1:ON %8-$3 / / /-10;;;;END OF COLUMN PROCESSING:%A = "%a":SL %A %1                 ;How long is number string:MC %2s//^/:%3 = %2-%1               ;Figure out placement of sum:MC %3:CM:SE %Ads//%A/:PR "%A";;;;RESET FOR NEXT COLUMN:%4 = %2                    ;go one space beyond current columnt/f%6:%a = 0:ON -1 62                   ;repeat process for next column;;;;ROW PROCESSINGt/f%6:MC %9:%b=0sl/£:ON ?-58 / / /-2:%b = !:FA %a%b:ON ?-13 /-4 / /-4:%A="%a":%a=0:SL %A %1:%3 = 15-%1:SF %B %3:SE %A:CM:on %A%C /+2 /+2 /       ;don't install if zero:PR "%B%A"s//%B%A/f1:ON %8-$3 /-18 / /-18;;;EXITt/F%6:MC %9:CP:EE 1;;;ERROR MESSAGES:PR"#1/#13/The last line of your data table must consist of #13/":IN"a single carriage return.  Please correct your text. #13/":ON -1 131;:PR"#1/#13/The data table line is too long.  It cannot be more than#13/":PR"159 characters long, including the newly created column#13/":IN"to contain the sum of the rows.#13/#13/":ON -1 131;:IN"#1/#13/Where is the data???#13/":ON -1 131