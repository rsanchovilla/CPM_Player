;       macro to page a document;:pr "#1/#13/      ***  –¡«≈Œ’Õ Õ¡√“œ∆≈¡‘’“≈ ***#13/#13/":pr "This macro will number the pages of a document from  #13/":pr "1 to 30,000. The following limitations apply to      #13/":pr "page numbering done with this macro:                 #13/":pr "                                                     #13/":pr "  ** The document to be printed must be in a disk    #13/":pr "     file. It cannot be in your work space.          #13/":pr "                                                     #13/":pr "  ** Page numbering must be embedded in a .H         #13/":pr "     statement with the ££ notation.                 #13/":pr "                                                     #13/":pr "  ** The .Y statement for a title must come          #13/":pr "     immediately before the .H statement specifying  #13/":pr "     the title.                                      #13/":pr "                                                     #13/":pr "#13/Do you want to pause ":in "between pages? (0=no, 1=yes) " %7:IN "#13/Enter the number of the first page:  " %1:%9 = $4:on -1 125              ;set up the files;       loop here to get the next file:%9 = $4:on -1 145              ;get the next file name:sl %A %9:on %9 1000 1000 /      ;done?ro/%A/:on $0 /+4 / /+4        ;if can't be opened, exit:pr "#1/file %A can't be opened. Hit a key to exit.":in:on -1 1000R10                     ;read in any dot command headerJ1/E                    ;install the Y-tablefhfyh0/h2                   ;put the title and y-tab in the holdT/F/F1:%3 = $3:%2 = 0;       loop here for another paget/F/F1:on $0 /+1 / /+1        ;file open?:on ?-3  25 25 /        ;no more file?:on $0  / /+1 /         ;if file open, read somee/r120-$3                ;read enough for 100 lines:on $0 60 / 60          ;end of file reached?e/b1:on ?-46 /+3 / /+3      ;see if a .e here:mc $2+1:on ?-69 / 60 /         ;see if an e:on ?-101 / 60 /f1/s//<.E</;       now look for a new .H before start of page;t/f%3-1                 ;GO TO CURRENT POSITION:MC %2:on ?-46 /+10 / /+10:mc $2+1:on ?-72  / /+3         ;look for .h or .H:on ?-104 / /+2f1:on -1 /-6b1                      ;handle a new .hsl/*.y /?/               ;see if last line was a .y:on ?-16 160 / /        ;must have a .yb0/h0/h2/u/f1/d1        ;install new .y and .h, removing .he/s//^</fy                      ;get current y tableU                       ;now install the next page's .h100S/\#\#/%1/           ;replace page number notationb3/j1/b/d100;       now print the page;t/f%3-1:MC %2;p:%4 = %3:%3 = $3                ;update row and column count:%2 = $2:%1 = %1+1              ;bump the page counter:CP:on %7 / /+2:in "#0/#6/Change paper, then hit any key to continue...":pr "#0/#6/"t/f%4-1                 ;back to the top of the pages/*.h/?/                ;look for a .h on this page:on $3-%3 / /+5 /+5     ;if current line or greater, don't installb1sl/*.y /?/               ;see if last line was a .y:on ?-16 160 / /        ;must have a .yb0/h0/h2/u              ;install new .y and .ht/f%3-1:mc %2                  ;restore position;       go back, searching for a return;:on $3-1 / /+10 /       ;if row 1, give upb1sl/</</:on ?-13 /-4 / /-4      ;try to find a returnb0:%4 = $3                ;LINE TO DELETE UP TOT/F/F1:%4 = %4-$3+1           ;SUBTRACT LINES IN FILE AREAd%4                     ;DELETE LINES NOT NEEDED:%3 = %3-%4             ;back up the row count;;:on -1 45;;;       100 get the list of file namesT/S// ^</             ;Mark start of file list:%6 = 1                 ;file counter:pr "#1/≈ÓÙÂÚ ÊÈÏÂÓ·ÌÂ ·Ó‰ ÚÂÛÛ “≈‘’“ŒÆ":%2 = %6+2              ;LOOP here for next file:PR "#0/":PR "#3/":%2 = %2-1:on %2-1 / / /-3        ;print lfs to reach next entry:pr "File no %6  #6/":in %A                  ;Name file:sl %A %3:on %3 %9 %9 /          ;if no name, we're donero/%A/                  ;test open the file:on $0 / /+3 /          ;not open, then don't bump counterrd:%6 = %6+1e/B1/s//%A</            ;Add file to list:on -1 /-15             ;go get another one;       120 get the next fileT                       ;LOOP here to get files:%A = "":on ?-94  /+2 / /+2     ;return with no fileB0/D1:ON -1 %9:%A = !                 ;Get filename from top of listb0/d1:on -1 %9;       160     error exit;:pr "#0/#6/An embedded .H statement must be preceded by a .Y statement":CP:in "#13/#6/Hit a key to exit"