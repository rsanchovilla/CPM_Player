###                      8-10-83                *** маил лабел мацрофеатуре  ***        This macro allows you to fill in a label template ofyour design with information from successive customer records.The labels are written to disk for future printing.        The disk files 'LABEL.TEM' and 'CUSLIST.DEM' areformatted correctly for use by this macro, and can be used fordemonstration purposes.##A       "10"    "HOW MANY LINES PER CUSTOMER RECORD?            "C       "1 "    "SET 1 WITH CUE OR SORT LINE, 0 WITHOUT         "D       "0 "    "SET 0 BY PAGE, 1 CONTINUOUS ROLL               "E       "3 "    "HOW MANY LABELS ACROSS THE PAGE                "F       "11"    "HOW MANY LABELS DOWN THE PAGE,SET 1 FOR ROLL   "G       "33"    "WIDTH OF LABEL IN CHARACTERS                   "H       "6 "    "HEIGHT OF LABEL IN LINES                       "#;:ON -1 220      ;SET UP OPTIONS:PR "#1/"       ;CLEAR SCREEN:IN "#1/#13/#13/#6/Filename of label template:  " %ARO/%A/          ;OPEN FILE:ON $0 / /-3 /    ;TRY AGAINR:%1 = $3E:%2 = $3:%1 = %2-%1     ;NUMBER OF PRINT LINES:%I = %1        ;SAVE:%2 = %H        ;LABEL HEIGHT:%2 = %2-%1:%K = %2        ;SPACER LINEST/H  ;HOLD TEMPLATE:IN "#0/#13/#13/#13/#13/#6/Filename of Address File:   " %ARO/%A/:ON $0 / /-3 /:IN "#0/#13/#13/#13/#13/#13/#13/#6/Filename for mail labels:    " %AWO/%A/:ON $1 / /-3 / ;:%2 = $E:%0 = 0:%0 = %0+$G:%2 = %2-1:ON %2 / / /-3  ;MAY BE >80 CHARSL%0:ON $C / /+3 /  ;CUELINE?:%1 = %J:%1 = %1-1:%J = %1        ;NUM OF LINES TO SEARCH:%0 = 1         ;LABEL CTR;       35:%6 = %E        ;SAVE, %E=LABEL ACROSS:%4 = 0;       38T/R$A             ;READ ONE RECORD:ON ?-3 /+1 / /+1   ;EOF:ON %6-%E 52 189 51 ;SHORT ROW?:ON $C / 49 /  ;CUE LINE?:ON ?-46 / 47 / ;".":ON ?-65 / 47 / ;"A":IN "#0/#6/ERROR IN RECORD SEPARATOR":ON -1 250      ;EXIT;       47D1              ;DROP CUELINE:%4 = %4+1:%6 = %6-1:ON %6 38 / 38       ;FULL ROW ACROSS?:%E = %4E/U/E/S//^</    ;UNHOLD TEMPLATES SEPARATED BY MARKS:%4 = %4-1:ON %4 / / /-3:%4 = 0         ;TEMPL CTR:%3 = %J        ;LINES/REC:%6 = %E:%5 = 0;       60T:%5 = %5+1      ;NUM OF DATA FIELD;:ON ?-3 74 / 74 ;EOF?;       65:ON %4 / 194 /   ;SHORT ROW?;;;       69:%2 = %6-%4%3S//</         ;PAD ROW:%2 = %2-1:ON %2 / /-3 /;       74;;:%G = !<        ;PICK UP FIELD IN CUS RECB0/D1:ON %4 / /+2 /  ;1ST TEMPL?%4F/F1;;;;S/@%5/%G/       ;INSERT DATA IF FOUND:ON %3-%5 / / 60        ;SEARCHED ON ALL FIELDS?:%4 = %4+1:%5 = 0;:ON %6-%4 / / 60        ;FILLED FULL ROW?;       91:%2 = %I        ;PRINT LINES:%4 = 0T/F%5/F%4:ON ?-13 /+2 / /+2      ;EMPTY LINED1/F/S//</B1:ON -1 100:%4 = %4+1:ON %2-%4 / / 94:%1 = %K                ;INSERT SPACERS:ON %1 /+1 /+1 /        ;ANY SPACERS?%1F/S//</B1:%5 = %5+%2+%1+1        ;SKIP TO NEXT REC:%6 = %6-1:ON %6 / / 91          ;ALL RECS?;   106  PREP TO WRITET:%1 = $H        ;LABEL HEIGHT IN LINES:%3 = %8-2:%2 = $3;:pr "#1/#13/#13/";       113:%6 = %E:%4 = 1:%B = !<        ;FORMAT PRINT ROW:pr "%B#13/"B0/D1:SF %B %8-1     ;EXPAND TO FULL LABELS//%B</B1:ON %6-1 / 130 /        ;ONLY 1 ACROSS?;;;       124;S/</``%4</B1    ;INSERT MARKERS FOR SUBSEQ LABELS;;:%4 = %4+1;       130:ON %6-%4 / / 124  ;FULL ROW?;;;       134;:%1 = %1-1T/F%2:%2 = %2+1;:ON %1 / / 113   ;NEXT LINE OF LABEL:%1 = $H:%4 = 1:ON %6-1 / 158 /        ;ONLY 1 ACROSS?;;;       146      INSERT FIELDS T/F/F1:%B = !<:pr "%B#13/"B0/D1:SF %B %8-1T/S/``%4/`%B/;:%1 =%1-1:ON %1 / / 146T/F/D1           ;REMOVE MARK:%4 = %4+1:%1 = $H:ON %4-%6 146 / /        ;FULL ROW OF LABELS?;:%3 = $D:%1 = $G:%1 = %1-1:%B = " ":SF %B %1:%6 = $ET/SA/`%B</</    ;DELETE EXTRA SPACES:%6 = %6-1:ON %6-1 / / /-3T/SA/%B</</:ON $0 / 189 /;       172:%9 = %9-1:ON %3-1 / 189 /        ;ROLL?:ON %9 189 / 189      ;END OF PAGE;;;;;;      181T/F/D1/         ;REMOVE MARK:%9 = $F:%1 = $H:%1 = %1+1:ON -1 192;;;       189T/F/D1:%1 = $H:ON -1 200      ;CTR MSGT/W%1/T/D;       194:ON $0 35 / 35        ;EOF?T/H0/WD/L79:ON -1 250              ;EXIT;;;       200:cp:PR "#0/Writing Label Number  %0#6/":%6 = %E:%0 = %0+%6:ON -1 193;;;;;;;;;;;;;;;       220     SET UP OPTIONSH0              ;CLEAR BUFF:%1 = $0        ;READ FILE STATUS:ON %1 / /+2 /  RD              ;CLOSE FILE;:SS 15 $G $G $G $G $G $G 3 3 3 3 3 3 3 3 3 3 3;:%J = $A        ;NUMBER OF LINES IN RECORD:%E = $E        ;LABELS ACROSS PAGE:%9 = $F        ;LABELS DOWN PAGE:%8 = $G        ;LABEL WIDTH:%H = $H        ;LABEL HEIGHT:ON -1 3        ;RET;;;;;;;   240  EXIT