10    ' MONOP    MONOPOLY BORROWED FROM HP2000 SYSTEM REVISED 2.08.81
20    ' REVISED FOR CPM MBASIC-80 06/26/82
30    '
40    ' REVISED FOR THE HEATH/ZENITH H/Z-89 WITH MBASIC 5.21
50    '                                                       06/20/85
60    ' BY   Richard E. Bacon
70    '      P.O. Box 165
80    '      Rowlett, TX 75088            (214) 475-5414
90    '
100   '
110   ' Revised for the H/Z-100 using MBASIC or DRI's Personal BASIC
120   ' 8/4/85     by Bob Willink
130   '               P.O. Box 701
140   '               McKinney, TX  75069
141   '
142   ' Revised for Kaypro '84 graphics                10/2/85
143   '    Screen codes for other terminals can easily be incorporated
144   '    by changing the control codes in lines 150-170
145   '             Keith Sorbo, Dallas, TX  
150   ' 
151   ' If your terminal has no dim set both DIM and BRT codes the same 
152   DIMON$ = CHR$(27) + "B0" + CHR$(27) + "B1":'Turn on dim reverse mode
154   DIMOF$ = CHR$(27) + "C0" + CHR$(27) + "C1":'Turn off dim reverse mode 
156   CLS$ = CHR$(26):                       'Clear screen, home cursor
158   DEF FNC$(R,C) = CHR$(27) + "=" + CHR$(R+32) + CHR$(C+32):'Cursor addressing
160   BRTON$=CHR$(27)+"B0":     'Turn on Bright reverse mode
170   BRTOF$ = CHR$(27) + "C0": 'Turn off Bright reverse mode
172   UNDON$ = CHR$(27) + "B3": 'Turn on underlining
174   UNDOF$ = CHR$(27) + "C3": 'Turn off underlining 
176   BLKON$ = CHR$(27) + "B2": 'Turn blink on
178   BLKOF$ = CHR$(27) + "C2" : 'Turn blink off
180  WIDTH 225
190   DATA "MEDDITERANEAN AVE"," CCH ","BALTIC AVE"," INC "
200   DATA "READING RR","ORIENTAL AVE","  ?  ","VERMONT AVE"
210   DATA "CONNECTICUT AVE"," JAIL","ST CHARLES PLACE"
220   DATA "ELECTRIC CO","STATES AVE","VIRGINIA AVE"
230   DATA "PENN. RR","ST JAMES PLACE"," CCH ","TENNESSEE AVE"
240   DATA "NEW YORK AVE"," FRE ","KENTUCKY AVE","  ?  "
250   DATA "INDIANA AVE","ILLINOIS AVE","B&O RR","ATLANTIC AVE"
260   DATA "VENTNOR AVE","WATER WORKS","MARVIN GARDENS"," GTJ "
270   DATA "PACIFIC AVE","NO. CAROLINA"," CCH ","PENNSYLVANIA AVE"
280   DATA "SHORT LINE RR","  ?  ","PARK PLACE"," LUX ","BOARD WALK"
290   DATA " GO! "
300   PRINT CLS$;
370   GOSUB 7720
380   I$="":PRINT FNC$(10,26);:INPUT"WANT INSTRUCTIONS";I$
390   IF I$="" THEN 380
400   IF LEFT$(I$,1)="Y" THEN GOSUB 8360 ELSE GOSUB 8120
410   DIM U(10)
420   DIM I(30),G(10,3),R(16,6),B(39,3),P(39),A(2,2)
430   DIM J(2,2),L(2),X(3),Z(3),C(32)
440   DEF FNG(K)=INT(K/5+1)
450   DEF FNF(K)=(9*ABS(INT(K/5)*5=K)+10*ABS(K=12 OR K=28))
460   DEF FNR(K)=-ABS(ABS((K+1)/5<>INT((K+1)/5)) AND ABS(K<>3))
470   DEF FNN(K)=INT(K*RND(1)+1)
480   DEF FNH(K)=50*INT((K+1)/2)
490   X9=1
500   GOSUB 3520
510   GOSUB 3950
520   R0=D1+D2
530   GOSUB 3950
540   IF R0<D1+D2 THEN 660
550   IF R0=D1+D2 THEN 510
560   T=1
570   GOSUB 8140
580   PRINT FNC$(ZL,18);"YOU'RE FIRST!":ZL=ZL+1
590   D=0
600   ON T GOSUB 7000,7480
610   ON T GOTO 1420,1450
620   IF J(T,2)=0 THEN 700
630   GOSUB 4450
640   IF J(T,2)=0 THEN 700
650   GOTO 1330
660   GOSUB 8140
670   PRINT FNC$(ZL,18);"COMAC IS FIRST!":ZL=ZL+1
680   T=2
690   GOTO 590
700   GOSUB 3950
710   R0=D1+D2
720   GOSUB 8330 'RESTORE LABEL
730   IF D=3 THEN 1270
740   D3=1
750   L(T)=L(T)+R0
760   W=200
770   IF L(T)<0 THEN L(T)=L(T)+40
780   IF L(T)<40 THEN 880
790   L(T)=L(T)-40
800   GOSUB 8140
810   IF L(T)=0 THEN 830
820   PRINT FNC$(ZL,18);"Passing ";
830   PRINT CHR$(7);CHR$(7);
840   PRINT FNC$(ZL,26);"GO!  COLLECT $200.":ZL=ZL+1
850   ON T GOSUB 7000,7480
860   IF L(T)<>0 THEN 880
870   L(T)=40:GOSUB 8340:L(T)=0:GOTO 890
880   GOSUB 8340
890   IF L(T)=0 THEN 1340
900   IF LEFT$(P$,1)<>" " THEN 940
910   Z$=P$
920   GOSUB 8170
930   ON X0 GOTO 1270,1750,1800,1480,1650,1680,1720
940   IF B(K8,1)=0 THEN 970
950   GOSUB 6750
960   GOTO 1340
970   A=3-T
980   GOSUB 8140
990   PRINT FNC$(ZL,18);P$;", PRICE $";P(K8):ZL=ZL+1
1000  A=3-A
1010  IF A=2 THEN 1150
1020  GOSUB 8140:PRINT FNC$(ZL,18);
1030  I$="":INPUT "WANT TO BUY ";I$
1040  IF I$="" THEN 1020
1050  ZL=ZL+1
1060  IF LEFT$(I$,1)="Y" THEN 1080
1070  ON ABS(A=T)+1 GOTO 1340,1000
1080  W=-P(K8)
1090  A7=0
1100  ON A GOSUB 7000,7480
1110  B(K8,1)=A
1120  XX=FNG(K8):XY=FNF(K8):IF XY>XX THEN XX=XY
1130  G(XX,A)=G(XX,A)+1
1140  GOTO 1340
1150  XX=FNG(K8):XY=FNF(K8):IF XY>XX THEN XX=XY
1160  G0=XX
1170  IF A(A,A)<P(K8) THEN 1210
1180  IF G0>8 OR G(G0,1)=0 THEN 1240
1190  IF G(G0,1) AND G(G0,2)=0 THEN 1240
1200  IF A(2,1)-P(K8)>100 THEN 1240
1210  GOSUB 8140
1220  PRINT FNC$(ZL,18);"COMAC passes!":ZL=ZL+1
1230  ON ABS(A=T)+1 GOTO 1340,1000
1240  GOSUB 8140
1250  PRINT FNC$(ZL,18);"COMAC will buy!":ZL=ZL+1
1260  GOTO 1080
1270  GOSUB 8140
1280  PRINT FNC$(ZL,18);"Go to jail, do not pass go!":ZL=ZL+1
1290  GOSUB 8330
1300  L(T)=10
1310  GOSUB 8340
1320  J(T,2)=3
1330  D1=-1
1340  T=(3-T)*ABS(D1<>D2)+T*ABS(D1=D2)
1350  D=D*ABS(D1=D2)
1360  IF T=2 THEN 1450
1370  IF D1=D2 THEN 1420
1380  GOSUB 2350
1390  GOSUB 6530
1400  ON Q8 GOSUB 4320
1410  GOSUB 6340
1420  GOSUB 8140
1430  PRINT FNC$(ZL,18);BRTON$;"YOUR MOVE";BRTOF$:ZL=ZL+1
1440  GOTO 620
1450  GOSUB 8140
1460  PRINT FNC$(ZL,18);DIMON$;"COMAC'S MOVE";DIMOF$;:ZL=ZL+1
1470  GOTO 620
1480  GOSUB 8140
1490  PRINT FNC$(ZL,18);"Income tax: $200 or 10%   ":ZL=ZL+1
1500  IF T=2 THEN 1620
1510  GOSUB 8140
1520  PRINT FNC$(ZL,18);
1530  Z$="":PRINT "WANT 10% ";:INPUT Z$
1540  IF Z$="" THEN 1510
1545  ZL=ZL+1
1550  IF LEFT$(Z$,1)="Y" THEN 1630
1560  W=-200
1570  GOSUB 8140
1580  PRINT FNC$(ZL,18);
1590  PRINT USING"$#### TAX MUST BE PAID!";-W:ZL=ZL+1
1600  ON T GOSUB 7000,7480
1610  GOTO 1340
1620  IF A(T,2) >= 2000 THEN 1560
1630  W=-INT(A(T,2)/10)
1640  GOTO 1570
1650  GOSUB 8140
1660  PRINT FNC$(ZL,18);"Free Parking":ZL=ZL+1
1670  GOTO 1340
1680  GOSUB 8140
1690  PRINT FNC$(ZL,18);"Luxury Tax, $75!":ZL=ZL+1
1700  W=-75
1710  GOTO 1600
1720  GOSUB 8140
1730  PRINT FNC$(ZL,18);"Just Visiting (JAIL)":ZL=ZL+1
1740  GOTO 1340
1750  GOSUB 8140
1760  PRINT FNC$(ZL,18);"Community Chest : ":ZL=ZL+1
1770  C1=(C1+1)*ABS(C1<16)+ABS(C1=16)
1780  L1=C(C1)
1790  GOTO 1840
1800  GOSUB 8140
1810  PRINT FNC$(ZL,18);"Chance : ":ZL=ZL+1
1820  C2=(C2+1)*ABS(C2<32)+17*ABS(C2=32)
1830  L1=C(C2)
1840  '
1850  GET#1,L1
1860  Z$=AA$:W=CVI(AB$):X8=CVI(AD$)
1870  IF W>0 THEN ON W GOTO 2070,2120,2140,2160,2200,2320
1880  IF X8 THEN 2000
1890  IF W<0 THEN 1970
1900  GOSUB 8140
1910  PRINT FNC$(ZL,18);Z$;" collect $";W:ZL=ZL+1
1920  ON T GOSUB 7000,7480
1930  IF L1<16 OR L1>17 THEN 1340
1940  W=-W
1950  ON T GOSUB 7480,7000
1960  GOTO 1340
1970  GOSUB 8140
1980  PRINT FNC$(ZL,18);"PAY ";Z$;" $";-W:ZL=ZL+1
1990  GOTO 1920
2000  IF X8<0 THEN 1270
2010  GOSUB 8140
2020  PRINT FNC$(ZL,18);"Advance token to ";Z$:ZL=ZL+1
2030  GOSUB 8330
2040  L(T)=X8+40*ABS(L(T)>X8)
2050  D3=2
2060  GOTO 760
2070  GOSUB 8140
2080  PRINT FNC$(ZL,18);"GO BACK 3":ZL=ZL+1
2090  GOSUB 8330
2100  L(T)=L(T)-3
2110  GOTO 760
2120  X8=28-16*ABS(L(T)=7 OR L(T)=36)
2130  GOTO 2010
2140  X8=25-10*ABS(L(T)=7)-20*ABS(L(T)=36)
2150  GOTO 2010
2160  GOSUB 8140
2170  PRINT FNC$(ZL,18);"Get out of jail free!":ZL=ZL+1
2180  J(T,1)=J(T,1)+1
2190  GOTO 1340
2200  X7=25:X8=25
2210  W=0
2220  FOR K7=1 TO 39
2230  W=W-(X7*B(K7,3)-X8*ABS(B(K7,3)=5))*ABS(B(K7,1)=T)
2240  NEXT K7
2250  GOSUB 8140
2260  PRINT FNC$(ZL,18);
2270  PRINT USING"TAX $#### PER HOUSE";X7:ZL=ZL+1:GOSUB 8140
2280  PRINT FNC$(ZL,18);
2290  PRINT USING"TAX $#### PER HOTEL";X7*5-X8:ZL=ZL+1
2300  Z$=""
2310  GOTO 1970
2320  X7=40
2330  X8=85
2340  GOTO 2210
2350  FOR K7=0 TO 8:U(K7)=0:NEXT K7
2360  FOR K7=0 TO 1
2370  FOR G1=1 TO 8
2380  X9=INT(A(2,1)/FNH(G1))
2390  IF X9=0 OR G(G1,2)-G(G1,3) OR U(G1) THEN 2750
2400  X8=ABS(G1>1 AND G1<8)
2410  GOSUB 5130
2420  X7=G(G1,3)*5-H
2430  IF X7=0 OR B(X1,2)+B(X2,2)+B(X3,2) THEN 2750
2440  V7=X1-L(1)+40*ABS(X1-L(1)<0)
2450  IF K7=0 AND (V7<5 OR V7>14) THEN 2750
2460  X6=FNN(X9):IF X7<X6 THEN X6=X7
2470  Z(1)=INT(X6/(2+X8)):Z(2)=Z(1):Z(3)=Z(1)
2480  X6=X6-Z(1)*(2+X8)
2490  IF X6=0 THEN 2580
2500  FOR K8=2+X8 TO 1 STEP -1
2510  FOR K9=2+X8 TO 1 STEP -1
2520  IF B(X(K8),3)>B(X(K9),3) THEN 2570
2530  NEXT K9
2540  Z(K8)=Z(K8)+1
2550  X6=X6-1
2560  IF X6=0 THEN 2580
2570  NEXT K8
2580  FOR K8=1 TO 2+X8
2590  IF Z(K8)=0 THEN 2730
2600  RESTORE
2610  FOR K9=1 TO X(K8)
2620  READ P$
2630  NEXT K9
2640  GOSUB 8140
2650  PRINT FNC$(ZL,18);
2660  PRINT USING"COMAC BUYS # HOUSE(S)";Z(K8):ZL=ZL+1:GOSUB 8140
2670  PRINT FNC$(ZL,18);
2680  PRINT USING"ON \               \";P$:ZL=ZL+1
2690  W=-Z(K8)*FNH(G1)
2700  A7=0
2710  GOSUB 7480
2720  B(X(K8),3)=B(X(K8),3)+Z(K8)
2730  NEXT K8
2740  U(G1)=1
2750  NEXT G1
2760  NEXT K7
2770  RETURN 
2780  W=0
2790  T1=1
2800  IF I1=0 THEN 2860
2810  GOSUB 3460
2820  GOSUB 4940
2830  GOSUB 7100
2840  IF I1 THEN 2810
2850  RETURN 
2860  GOSUB 7070
2870  RETURN 
2880  S0=5
2890  L$="MINCOMGROFREATTCAS"
2900  O$="FYC M"
2910  IF I1=0 THEN 3070
2920  GOSUB 3460
2930  S1=0:S1=INSTR(L$,LEFT$(Z$,3))
2940  S0=INT((S1+2)/3)
2950  IF S0 THEN 3000
2960  GOSUB 3090
2970  IF I1=0 THEN 3080
2980  GOSUB 3460
2990  GOTO 2960
3000  M=-1
3010  ON S0 GOTO 3020,3020,2970,3070,3350,4320
3020  IF I1=0 THEN 3070
3030  GOSUB 3460
3040  IF LEFT$(Z$,3)="MOR" THEN 3060
3050  M=M-1
3060  M=M+2
3070  GOSUB 3090
3080  RETURN 
3090  RESTORE
3100  FOR K5=1 TO 39
3110  READ P$
3120  IF LEFT$(P$,1)="" THEN 3330
3130  IF S0=5 THEN 3240
3140  XX=FNG(K5):XY=FNF(K5):IF XY>XX THEN XX=XY
3150  G0=XX
3160  IF S0<>3 THEN 3190
3170  IF LEFT$(Z$,2)=MID$(R$,G0*2-1,2) THEN 3240
3180  GOTO 3330
3190  IF S0<>0 THEN 3220
3200  IF LEFT$(Z$,5)=LEFT$(P$,5) THEN 3240
3210  GOTO 3330
3220  IF B(K5,1)=S0 AND ABS(B(K5,2)=M OR M=-1) THEN 3240
3230  IF S0<>4 OR B(K5,1)<>0 THEN 3330
3240  GOSUB 8140
3250  PRINT FNC$(ZL,18);MID$(O$,B(K5,1)+1,1);MID$(O$,B(K5,2)+4,1);
3260  PRINT MID$(O$,B(K5,2)+4,1);
3270  PRINT " ";P$;:ZL=ZL+1
3280  IF B(K5,3)=0 THEN 3310
3290  GOSUB 8140
3300  PRINT FNC$(ZL,18);"Houses =";B(K5,3):ZL=ZL+1
3310  PRINT 
3320  IF S0=0 THEN 3340
3330  NEXT K5
3340  RETURN 
3350  V$="PURPLEL.BLUEVIOLETORANGERED   YELLOWGREEN D.BLUERAIL  UTIL  "
3360  FOR Q9=1 TO 10
3370  GOSUB 8140
3380  PRINT FNC$(ZL,18);MID$(V$,6*Q9-5,6);" - ";
3390  IF G(Q9,1)+G(Q9,2)=0 THEN PRINT FNC$(ZL,28);"FREE":ZL=ZL+1:GOTO 3440
3400  IF (G(Q9,1)<>0 AND G(Q9,2)<>0) THEN PRINT FNC$(ZL,28);"NOT attainable":ZL=ZL+1:GOTO 3440
3410  IF G(Q9,1)<>0 THEN PRINT FNC$(ZL,18);"YOU   -";G(Q9,1):GOTO 3440
3420  GOSUB 8140
3430  PRINT FNC$(ZL,18);"COMAC -";G(Q9,2)
3440  NEXT Q9
3450  RETURN 
3460  I1=I1+1
3470  Z$=MID$(I$,I(I1),I(I1+1)-2-I(I1)+1)
3480  I1=I1*ABS(I1<>Q5)
3490  B9=LEN(Z$)+1
3500  Z$=Z$+" "
3510  RETURN 
3520  FOR K=0 TO 10:FOR KK=0 TO 3:G(K,KK)=0:NEXT KK:NEXT K:'MAT G=ZER
3530  FOR K=1 TO 10:G(K,3)=3-ABS(K=1)-ABS(K=8)+ABS(K=9)-ABS(K=10):NEXT K
3540  FOR K=0 TO 39:FOR KK=0 TO 3:B(K,KK)=0:NEXT KK:NEXT K:'MAT B=ZER
3550  FOR K=0 TO 2:FOR KK=0 TO 2:A(K,KK)=1:NEXT KK:NEXT K:'MAT A=CON
3560  FOR K=0 TO 2:FOR KK=0 TO 2:A(K,KK)=A(K,KK)*1500:NEXT KK:NEXT K
3570  T=0
3580  FOR K=0 TO 2:FOR KK=0 TO 2:J(K,KK)=0:NEXT KK:NEXT K:' MAT J=ZER
3590  FOR K=0 TO 2:L(K)=0:NEXT:' MAT L=ZER
3600  CLOSE:OPEN"R",#1,"WMONOP.DAT"
3610  FIELD #1,20 AS AA$,2 AS AB$,2 AS AD$,4 AS AE$,4 AS AF$,2 AS AG$, 2 AS AH$,2 AS AI$
3620  GET #1,50:N=CVI(AB$):RANDOMIZE N:N=INT(20000*RND(1))
3630  LSET AB$=MKI$(N):PUT #1,50
3640  FOR K=1 TO 16
3650  GET #1,K:R1=CVS(AE$):R2=CVS(AF$)
3660  R(K,1)=2*K+5*ABS(K=15)+18*ABS(K=16)
3670  R(K,2)=5*R(K,1)+10*ABS(K=14)-50*ABS(K=16)
3680  R(K,6)=INT(R2/100)
3690  R(K,3)=R2*10-R(K,6)*1000
3700  R(K,4)=INT(R1/10000)*10
3710  R(K,5)=R1-R(K,4)*1000
3720  NEXT K
3730  D=0:W=0
3740  RESTORE
3750  FOR K=1 TO 39
3760  READ P$
3770  IF LEN(P$)=1 THEN 3800
3780  XX=FNG(K):XY=FNF(K):IF XY>XX THEN XX=XY
3790  P(K)=60+40*(XX-1)+ABS((((2*XX-FNR(K))/XX)=2)*20*(K<>3))+ABS(K=37)*10+ABS(K=39)*40
3800  NEXT K
3810  P(5)=200:P(15)=200:P(25)=200:P(35)=200
3820  P(12)=150:P(28)=150
3830  FOR K=1 TO 32:C(K)=0:NEXT K
3840  FOR K=1 TO 32
3850  X=FNN(16)+ABS(K>16)*16
3860  IF C(X) THEN 3850
3870  C(X)=K
3880  NEXT K
3890  R$="PUL.VIORREYEGRD.RRUT"
3900  C1=0
3910  C2=16
3920  I1=0
3930  A7=1:T1=1:Q8=1
3940  RETURN
3950  D1=FNN(6)
3960  D2=FNN(6)
3970  D=D+ABS(D1=D2)
3980  GOSUB 8140
3990  PRINT FNC$(ZL,18);
4000  PRINT USING"ROLL:    # - #";D1;D2
4010  ZL=ZL+1
4020  RETURN
4030  'GOSUB 9130
4040  I$="":LINE INPUT I$:Z=LEN(I$)
4050  I1=0
4060  PRINT 
4070  IF I$="" THEN 4090
4080  GOTO 4130
4090  IF C9 THEN 4260
4100  GOSUB 8140
4110  PRINT FNC$(ZL,18);"BAD.  Retype-";
4120  GOTO 4030
4130  FOR K=0 TO 30:I(K)=0:NEXT K
4140  X4=0
4150  Q5=0
4160  FOR K9=1 TO LEN(I$)
4170  IF MID$(I$,K9,1)="," THEN 4230
4180  IF X4  THEN 4240
4190  Q5=Q5+1
4200  I(Q5)=K9
4210  X4=1
4220  GOTO 4240
4230  X4=0
4240  NEXT K9
4250  I(Q5+1)=LEN(I$)+2
4260  RETURN 
4270  N$="1234567"
4280  FOR X0=7 TO 1 STEP -1
4290  IF LEFT$(Z$,1)=MID$(N$,X0,1) THEN 4310
4300  NEXT X0
4310  RETURN 
4320  ' Put assets at bottom of screen
4330  PRINT FNC$(23,3);
4340  PRINT USING"YOUR Cash[$#####] Assets[$#####]   ";A(1,1);A(1,2);
4370  PRINT USING "COMAC'S Cash[$#####] Assets[$#####]";A(2,1);A(2,2);
4380  ZL=ZL+1
4390  RETURN
4400  GOSUB 8140
4410  PRINT
4420  PRINT FNC$(ZL,18);
4430  PRINT USING "YOUR CASH = $#####.  ";A(1,1);:ZL=ZL+1
4440  RETURN 
4450  IF J(T,1)=0 THEN ON T GOTO 4530,4720
4460  IF T=2 THEN 4790
4470  GOSUB 8140
4480  PRINT FNC$(ZL,18);"Use jail card ";:ZL=ZL+1
4490  Z$="":INPUT Z$:IF Z$="" THEN 4470
4500  IF LEFT$(Z$,1)="N" THEN 4640
4510  J(T,1)=J(T,1)-1
4520  GOTO 4600
4530  GOSUB 8140
4540  PRINT FNC$(ZL,18);:Z$=""
4550  INPUT "Pay $50 to be free ";Z$
4560  IF Z$="" THEN 4540
4565  ZL=ZL+1
4570  IF LEFT$(Z$,1)<>"Y" THEN 4640
4580  W=-50
4590  ON T GOSUB 7000,7480
4600  J(T,2)=0:D1=0
4610  GOSUB 8140
4620  PRINT FNC$(ZL,18);"Freed!":ZL=ZL+1
4630  RETURN 
4640  J(T,2)=J(T,2)-1
4650  D=0
4660  GOSUB 3950
4670  IF D THEN 4600
4680  IF J(T,2) THEN 4630
4690  GOSUB 8140
4700  PRINT FNC$(ZL,28);"$50 fee mandatory!";ZL=ZL+1
4710  GOTO 4580
4720  FOR K=1 TO 8
4730  IF (G(K,1) AND G(K,2) OR G(K,1)+ABS(G(K,2)=G(K,3)))=0 THEN 4760
4740  NEXT K
4750  IF A(T,1)<1000 THEN 4640
4760  GOSUB 8140
4770  PRINT FNC$(ZL,18);"COMAC pays $50 to be free!":ZL=ZL+1
4780  GOTO 4580
4790  GOSUB 8140
4800  PRINT FNC$(ZL,18);"COMAC uses jail card!":ZL=ZL+1
4810  GOTO 4510
4820  GOSUB 8140
4830  PRINT FNC$(ZL,18);" Property name-";:ZL=ZL+1
4840  X=0
4850  W9=W
4860  Z$="":LINE INPUT Z$:Z=LEN(Z$)
4870  ZL=ZL+1
4880  IF Z >= 0 THEN 4920
4890  GOSUB 6340
4900  Z$=""
4910  RETURN 
4920  IF Z$="" THEN 4890
4930  GOSUB 3490
4940  Z$=LEFT$(Z$,5)
4950  T1=1
4960  X=0
4970  K2=39
4980  S0=(T1=2)
4990  RESTORE
5000  FOR K9=1 TO K2
5010  READ P$
5020  IF S0 THEN 5040
5030  IF LEFT$(P$,5)=Z$ THEN 5070
5040  NEXT K9
5050  IF S0=0 THEN 5200
5060  K9=K9-1
5070  X1=2:X2=2:X3=2
5080  H=0
5090  X=K9
5100  XX=FNG(X):XY=FNF(X):IF XY>XX THEN XX=XY
5110  G1=XX
5120  IF G1>8 THEN 5200
5130  '
5140  GET#1,G1
5150  X1=CVI(AG$):X2=CVI(AH$):X3=CVI(AI$)
5160  X(1)=X1
5170  X(2)=X2
5180  X(3)=X3
5190  H=B(X1,3)+B(X2,3)+B(X3,3)
5200  RETURN 
5210  X9=A(1,2)-A(2,2)
5220  ON SGN(X9)+1 GOTO 5260,5290
5230  GOSUB 8140
5240  PRINT FNC$(ZL,18);"COMAC ahead by $";-X9:ZL=ZL+1
5250  GOTO 5310
5260  GOSUB 8140
5270  PRINT FNC$(ZL,18);"TIED AT $";A(1,2):ZL=ZL+1
5280  GOTO 5310
5290  GOSUB 8140
5300  PRINT FNC$(ZL,18);"You're ahead by $";X9:ZL=ZL+1
5310  GOTO 7680
5320  STOP 
5330  X=0
5340  IF I1=0 THEN GOSUB 5780
5350  GOSUB 3460
5360  IF LEFT$(Z$,3)<>"GRO" THEN 5470
5370  IF I1=0 THEN GOSUB 5820
5380  GOSUB 3460
5390  FOR G1=1 TO 8
5400  IF LEFT$(Z$,2)=MID$(R$,G1*2-1,2) THEN 5450
5410  NEXT G1
5420  GOSUB 8140
5430  PRINT FNC$(ZL,18);"Unable to comply!":ZL=ZL+1
5440  RETURN 
5450  GOSUB 5120
5460  GOTO 5500
5470  GOSUB 4940
5480  IF X=0 OR G1>8 THEN 5420
5490  IF B(X,1)<>1 THEN 5420
5500  IF G(G1,1)<>G(G1,3) OR H=G(G1,3)*5 THEN 5420
5510  IF B(X2,2)+B(X2,2)+B(X3,2) THEN 5420
5520  GOSUB 8140
5530  PRINT FNC$(ZL,18);"PRICE/HOUSE $";FNH(G1);",":ZL=ZL+1
5540  IF I1=0 THEN GOSUB 5850
5550  GOSUB 3460
5560  GOSUB 4270
5570  IF X0=0 THEN 5390
5580  IF X=0 THEN 5880
5590  IF B(X,3)+X0<6 THEN 5620
5600  X0=5-B(X,3)
5610  IF X0=0 THEN 5750
5620  D1=7
5630  FOR K7=1 TO G(G1,3)
5640  IF D1> B(X(K7),3) THEN D1=B(X(K7),3)
5650  NEXT K7
5660  IF X0+B(X,3) <= D1+1 THEN 5680
5670  IF D1+1-B(X,3)>0 THEN X0=D1+1-B(X,3) ELSE X0=0
5680  B(X,3)=B(X,3)+X0
5690  W=-X0*FNH(G1)
5700  A7=0
5710  GOSUB 7000
5720  GOSUB 8140:PRINT FNC$(ZL,18);
5730  PRINT USING "## HOUSE(S) BOUGHT!";X0:ZL=ZL+1
5740  RETURN 
5750  GOSUB 8140
5760  PRINT FNC$(ZL,18);"Hotel already exists!":ZL=ZL+1
5770  RETURN 
5780  GOSUB 8140
5790  PRINT FNC$(ZL,18);"Property name ";:ZL=ZL+1
5800  GOSUB 4030
5810  RETURN 
5820  GOSUB 8140
5830  PRINT FNC$(ZL,18);"Group ";:ZL=ZL+1
5840  GOTO 5800
5850  GOSUB 8140
5860  PRINT FNC$(ZL,18);"No. of houses ";:ZL=ZL+1
5870  GOTO 5800
5880  T0=X0
5890  X0=0
5900  FOR K7=1 TO G(G1,3)
5910  IF T0+B(X(K7),3)<6 THEN 5950
5920  X0=X0+5-B(X(K7),3)
5930  B(X(K7),3)=5
5940  GOTO 5970
5950  X0=X0+T0
5960  B(X(K7),3)=B(X(K7),3)+T0
5970  NEXT K7
5980  GOTO 5690
5990  IF I1=0 THEN GOSUB 5780
6000  GOSUB 3460
6010  A0=0
6020  IF LEFT$(Z$,3)<>"ALL" THEN 6110
6030  A0=1
6040  FOR K7=39 TO 1 STEP -1
6050  IF B(K7,1)<>1 OR B(K7,2)=0 THEN 6090
6060  X=K7
6070  IF .55*P(X)>A(1,1) THEN 6310
6080  GOSUB 6150
6090  NEXT K7
6100  GOTO 6220
6110  GOSUB 4940
6120  IF X=0 THEN 6280
6130  IF B(X,1)<>1 OR B(X,2)=0 THEN 6280
6140  IF .55*P(X)>A(1,1) THEN 6310
6150  W=-P(X)/20
6160  GOSUB 7000
6170  W=W*10
6180  A7=0
6190  GOSUB 7000
6200  B(X,2)=0
6210  IF A0 THEN RETURN
6220  GOSUB 8140
6230  PRINT FNC$(ZL,18);"DONE. ":ZL=ZL+1
6240  GOSUB 4400
6250  IF A0 OR I1=0 THEN 6330
6260  GOSUB 3460
6270  GOTO 6110
6280  GOSUB 8140
6290  PRINT FNC$(ZL,18);"Unable to comply!":ZL=ZL+1
6300  GOTO 6250
6310  GOSUB 8140
6320  PRINT FNC$(ZL,18);"Insufficient funds, can't continue!":ZL=ZL+1
6330  RETURN
6340  GOSUB 8140
6350  PRINT FNC$(ZL,18);"<** COMMAND **>";:ZL=ZL+1
6360  C9=1
6370  GOSUB 4030
6380  'ZL=ZL+1
6390  IF I$="" THEN 6520
6400  GOSUB 3460
6410  C$="LISQUIBUYUNMMORCLSHLP"
6420  FOR K7=1 TO 7
6430  IF MID$(C$,K7*3-2,3)=LEFT$(Z$,3) THEN 6490
6440  NEXT K7
6450  GOSUB 8140
6460  PRINT FNC$(ZL,18);"ILLEGAL COMMAND... use HLP to list commands."
6470  ZL=ZL+1
6480  GOTO 6340
6490  C9=0
6500  ON K7 GOSUB 2880,5210,5330,5990,2780,7720,8360
6510  GOTO 6340
6520  RETURN 
6530  RESTORE
6540  FOR K4=1 TO 39
6550  READ P$
6560  IF LEN(P$)=1 THEN 6730
6570  IF B(K4,2)=0 OR B(K4,1)<>2 THEN 6730
6580  XX=FNG(K4):XY=FNF(K4):IF XY>XX THEN XX=XY
6590  G0=XX
6600  IF G0=9 AND A(2,1)>200 THEN 6640
6610  IF G(G0,2)=G(G0,3) THEN 6640
6620  X9=K4-L(1)+40*ABS(K4-L(1)<0)
6630  IF X9<7 OR X9>14 THEN 6730
6640  IF P(K4)*.55>A(2,1)-100 THEN 6730
6650  W=-P(K4)/20
6660  GOSUB 7480
6670  W=W*10
6680  A7=0
6690  GOSUB 7480
6700  GOSUB 8140
6710  PRINT FNC$(ZL,18);"COMAC pays off ";P$:ZL=ZL+1
6720  B(K4,2)=0
6730  NEXT K4
6740  RETURN 
6750  XX=FNG(L(T)):XY=FNF(L(T)):IF XY>XX THEN XX=XY
6760  G0=XX
6770  IF B(L(T),2) THEN 6900
6780  IF B(L(T),1)=T THEN 6930
6790  IF G0-8>0 THEN ON G0-8 GOTO 6960,6980
6800  XX=FNG(L(T)):XY=FNF(L(T)):IF XY>XX THEN XX=XY
6810  W=-R(2*XX+FNR(L(T)),B(L(T),3)+1)
6820  W=W+ABS(B(L(T),3)=0 AND G(G0,3-T)=G(G0,3) AND G0<9)*W
6830  GOSUB 8140
6840  PRINT FNC$(ZL,18);P$;" - $";FNC$(ZL,35);
6850  PRINT USING "#### RENT MUST BE PAID!";-W:ZL=ZL+1
6860  ON T GOSUB 7000,7480
6870  W=-W
6880  ON T GOSUB 7480,7000
6890  RETURN 
6900  GOSUB 8140
6910  PRINT FNC$(ZL,18);P$;" is mortgaged.":ZL=ZL+1
6920  RETURN 
6930  GOSUB 8140
6940  PRINT FNC$(ZL,18);P$;" - no rent.":ZL=ZL+1
6950  RETURN 
6960  W=-25*2^(G(9,3-T)-1)*D3
6970  GOTO 6830
6980  W=-(4+6*ABS(D3=2 OR G(10,3-T)=2))*R0
6990  GOTO 6830
7000  T1=1
7010  IF A(T1,2)+W<0 THEN 7420
7020  IF A(T1,1)+W >= 0 THEN 7380
7030  IF T1=2 THEN 7500
7040  GOSUB 8140:PRINT FNC$(ZL,18);
7050  PRINT USING "YOU ARE $ #### SHORT.";-W-A(T1,1):ZL=ZL+1
7060  GOSUB 8140:PRINT FNC$(ZL,18);"YOU MUST MORTGAGE!":ZL=ZL+1
7070  GOSUB 4820
7080  W=W9
7090  IF Z$="" THEN 7000
7100  IF X THEN 7140
7110  IF ZL>19 THEN GOSUB 8120
7120  PRINT FNC$(ZL,18);"IMPROPER PROPERTY - ";Z$:ZL=ZL+1
7130  GOTO 7000
7140  IF B(X,1)-T1 THEN 7110
7150  X5=H*FNH(G1)/2
7160  B(X1,3)=0:B(X2,3)=0:B(X3,3)=0
7170  A(T1,2)=INT(A(T1,2)-X5)
7180  A(T1,1)=INT(A(T1,1)+X5+P(X)/2)
7190  G(G1,T1)=G(G1,T1)-B(X,2)
7200  ON B(X,2)*T1 GOTO 7270,7310
7210  B(X,2)=1
7220  IF T1=2 THEN 7350
7230  GOSUB 8140
7240  PRINT FNC$(ZL,18);"DONE. ":ZL=ZL+1
7250  GOSUB 4400
7260  GOTO 7010
7270  GOSUB 8140
7280  PRINT FNC$(ZL,18);"SOLD. ":ZL=ZL+1
7290  B(X,1)=0:B(X,2)=0
7300  GOTO 7250
7310  GOSUB 8140
7320  PRINT FNC$(ZL,18);"COMAC sells ";P$:ZL=ZL+1
7330  B(X,1)=0:B(X,2)=0
7340  GOTO 7010
7350  GOSUB 8140
7360  PRINT FNC$(ZL,18);"COMAC mortgages ";P$:ZL=ZL+1
7370  GOTO 7010
7380  A(T1,1)=INT(A(T1,1)+W)
7390  A(T1,2)=INT(A(T1,2)+W*A7)
7400  A7=1:T1=1:Q8=1
7410  RETURN 
7420  A(3-T1,2)=A(3-T1,2)+A(T1,2)
7430  IF T1=1 THEN 7460
7440  GOSUB 8120:PRINT FNC$(ZL,18);"YOU WIN BY $";A(1,2):ZL=ZL+1
7450  GOTO 7680
7460  GOSUB 8120:PRINT FNC$(ZL,18);"COMAC WINS BY $";A(2,2):ZL=ZL+1
7470  GOTO 7680
7480  T1=2
7490  GOTO 7010
7500  FOR K1=1 TO 10
7510  FOR K2=39 TO 1 STEP -1
7520  IF B(K2,1)<>T1 THEN 7650
7530  XX=FNG(K2):XY=FNF(K2):IF XY>XX THEN XX=XY
7540  G0=XX
7550  GOSUB 4980
7560  ON B(K2,2)*(ABS(K1<5)+2*ABS(K1>4)) GOTO  7650,7610
7570  IF K1=1 AND G0<9 AND G(G0,3)>G(G0,2) THEN 7150
7580  IF K1=2 AND G0<9 AND G(G0,3)=G(G0,2) AND H=0 THEN 7150
7590  IF (K1=3 OR K1=4) AND K1=13-G0 THEN 7150
7600  ON ABS(K1=9)+1 GOTO 7650,7640
7610  ON ABS(K1<8 AND G0<9)+ABS(K1-3=G(G0,2)+2*ABS(K1=6)+ABS(K1=7))GOTO 7650,7150
7620  IF 14-(K1/2)=G0 THEN 7150
7630  GOTO 7650
7640  IF G0<9 AND G(G0,3)=G(G0,2) THEN 7150
7650  NEXT K2
7660  NEXT K1
7670  STOP 
7680  ZL=ZL+3
7690  GOSUB 8140:PRINT FNC$(ZL,18);
7700  'PRINT "PLAY AGAIN ";:INPUT;A$:IF LEFT$(A$,1)="Y" THEN GOTO 1705
7710  END
7715  GOSUB 100
7720  PRINT CLS$;
7725  VMR$ = DIMON$ + "|=====|"+ DIMOF$
7730  VMA$ = DIMON$ + "|"+ DIMOF$ + "     "+DIMON$+"|"+DIMOF$
7735  HML$ = DIMON$ + "|=====|=====|=====|=====|=====|=====|"
7740  HMR$ = "=====|=====|=====|=====|=====|"+DIMOF$
7741 RM=65
7742 LM=5
7743  HMT$=HML$+HMR$
7745  HMA$ = "     "+DIMON$ + "|" + DIMOF$ : 
7747  HMAT$ = VMA$ + HMA$ + HMA$ + HMA$ + HMA$ + HMA$ + HMA$
7748  HMA2$ = HMA$ + HMA$ + HMA$ + HMA$ 
7750  PRINT FNC$(0,LM);HMT$;
7760  PRINT FNC$(1,LM);HMAT$
7763  PRINT FNC$(1,LM+43);HMA2$
7765  PRINT FNC$(2,LM);HMT$
7770  FOR BI = 0 TO 14 STEP 2
7772  PRINT FNC$(BI+3,LM);VMA$;FNC$(BI+3,RM);VMA$
7774  PRINT FNC$(BI+4,LM);VMR$;FNC$(BI+4,RM);VMR$
7776  NEXT BI
7778  PRINT FNC$(19,LM);VMA$;FNC$(19,RM);VMA$
7780  PRINT FNC$(20,LM);HMT$
7784  PRINT FNC$(21,LM);HMAT$:PRINT FNC$(21,LM+43);HMA2$
7786  PRINT FNC$(22,LM);HMT$
7790 ' PRINT FNC$(23,36);DIMON$;"MONOPOLY";DIMOF$
8050  RESTORE
8060  FOR PL=1 TO 40
8070  READ P$
8080  GOSUB 8220
8090  PRINT FNC$(YL,XL);LEFT$(P$,5)
8100  NEXT PL
8110  RETURN
8120  FOR ZH=5 TO 19:PRINT FNC$(ZH,14);STRING$(51,32)
8130  NEXT ZH:ZL=6:RETURN
8140  'THIS ROUTINE WILL BLANK THE NEXT TWO LINES ON THE MASSAGE SCREEN
8150  FOR ZH=1 TO 2:PRINT FNC$((5+(ZL+ZH-5) MOD 15),14);STRING$(51,32);
8160  NEXT ZH:ZL=5+((ZL-5) MOD 15):PRINT:RETURN
8170  N$="TC?NRUA"
8180  FOR X0=7 TO 1 STEP -1
8190  IF MID$(Z$,3,1)=MID$(N$,X0,1) THEN 8210
8200  NEXT X0
8210  RETURN 
8220  'This routine determines the X,Y position of Property Label
8230  XL=10-ABS(10-(PL+15)MOD 20)
8240  IF XL>5 THEN XL=5
8250  XL=XL*SGN(20-(PL+15)MOD 40)*6+36
8260  YL=10-ABS(10-(PL+25)MOD 20)
8270  IF YL>5 THEN YL=5
8280  YL=YL*SGN(((PL+25)MOD 40)-20)*2+11
8290  RETURN
8300  RESTORE
8310  FOR K8=1 TO L(T):READ P$:NEXT K8
8320  K8=K8-1:RETURN
8330  IF L(T) = 0 THEN L(T) = 40: GOSUB 8334: L(T)=0:RETURN
8334  PL=L(T):GOSUB 8220:GOSUB 8300:PRINT FNC$(YL,XL);LEFT$(P$,5):RETURN
8340  PL=L(T):GOSUB 8220:GOSUB 8300:PRINT FNC$(YL,XL);
8350 IF T = 1 THEN PRINT BLKON$;BRTON$;LEFT$(P$,5);BRTOF$;BLKOF$:RETURN
8353 PRINT DIMON$;LEFT$(P$,5);DIMOF$;:RETURN
8355 RETURN
8360  GOSUB 8120
8370  OPEN "I",#2,"WMONOP.HLP"
8380  FOR HS=1 TO 5
8390  FOR K8=5 TO 15
8400  INPUT #2,I$
8410  PRINT FNC$(K8,18);I$
8420  NEXT K8
8430  INPUT #2,I$:PRINT FNC$(16,18);I$;:I$=INPUT$(1)
8440  GOSUB 8120
8450  NEXT HS
8460  CLOSE #2
8470  RETURN
 NEXT K8
8430  INPUT #2,I$:PRINT FNC$(16,18);I$